<!DOCTYPE html>


<html lang="zh-CN">
  

    <head>
      <meta charset="utf-8" />
        
      <meta
        name="viewport"
        content="width=device-width, initial-scale=1, maximum-scale=1"
      />
      <title> </title>
  <meta name="generator" content="hexo-theme-ayer">
      
      <link rel="shortcut icon" href="/favicon.ico" />
       
<link rel="stylesheet" href="/dist/main.css">

      
<link rel="stylesheet" href="/css/fonts/remixicon.css">

      
<link rel="stylesheet" href="/css/custom.css">
 
      <script src="https://cdn.staticfile.org/pace/1.2.4/pace.min.js"></script>
       
 

      <link
        rel="stylesheet"
        href="https://cdn.jsdelivr.net/npm/@sweetalert2/theme-bulma@5.0.1/bulma.min.css"
      />
      <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11.0.19/dist/sweetalert2.min.js"></script>

      <!-- mermaid -->
      
      <style>
        .swal2-styled.swal2-confirm {
          font-size: 1.6rem;
        }
      </style>
    </head>
  </html>
</html>


<body>
  <div id="app">
    
      
    <main class="content on">
      
<section class="cover">
    
      
      <a class="forkMe" href="https://github.com/Shen-Yu/hexo-theme-ayer"
        target="_blank"><img width="149" height="149" src="/images/forkme.png"
          class="attachment-full size-full" alt="Fork me on GitHub" data-recalc-dims="1"></a>
    
  <div class="cover-frame">
    <div class="bg-box">
      <img src="/images/cover1.jpg" alt="image frame" />
    </div>
    <div class="cover-inner text-center text-white">
      <h1><a href="/"></a></h1>
      <div id="subtitle-box">
        
        <span id="subtitle"></span>
        
      </div>
      <div>
        
      </div>
    </div>
  </div>
  <div class="cover-learn-more">
    <a href="javascript:void(0)" class="anchor"><i class="ri-arrow-down-line"></i></a>
  </div>
</section>



<script src="https://cdn.staticfile.org/typed.js/2.0.12/typed.min.js"></script>


<!-- Subtitle -->

  <script>
    try {
      var typed = new Typed("#subtitle", {
        strings: ['面朝大海，春暖花开', '愿你一生努力，一生被爱', '想要的都拥有，得不到的都释怀'],
        startDelay: 0,
        typeSpeed: 200,
        loop: true,
        backSpeed: 100,
        showCursor: true
      });
    } catch (err) {
      console.log(err)
    }
  </script>
  
<div id="main">
  <section class="outer">
  
  <ul class="ads">
    
        <li>
            <a target="_blank" rel="noopener" href="https://curl.qcloud.com/kvO7hb43">
                <img src="https://pic.imgdb.cn/item/62174b452ab3f51d912a5ccc.jpg" width="300" alt="云服务器限时秒杀">
            </a>
        </li>
    
        <li>
            <a target="_blank" rel="noopener" href="https://www.vultr.com/?ref=8630075">
                <img src="https://pic.imgdb.cn/item/62174b452ab3f51d912a5cd7.png" width="300" alt="vultr优惠vps">
            </a>
        </li>
    
</ul>
  
  
  

<div class="notice" style="margin-top:50px">
    <i class="ri-heart-fill"></i>
    <div class="notice-content" id="broad"></div>
</div>
<script type="text/javascript">
    fetch('https://v1.hitokoto.cn')
        .then(response => response.json())
        .then(data => {
            document.getElementById("broad").innerHTML = data.hitokoto;
        })
        .catch(console.error)
</script>

<style>
    .notice {
        padding: 20px;
        border: 1px dashed #e6e6e6;
        color: #969696;
        position: relative;
        display: inline-block;
        width: 100%;
        background: #fbfbfb50;
        border-radius: 10px;
    }

    .notice i {
        float: left;
        color: #999;
        font-size: 16px;
        padding-right: 10px;
        vertical-align: middle;
        margin-top: -2px;
    }

    .notice-content {
        display: initial;
        vertical-align: middle;
    }
</style>
  
  <article class="articles">
    
    
    
    
    <article
  id="post-Redis"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2022/05/12/Redis/"
    >Redis</a> 
</h2>
 

      
    </header>
     
    <div class="article-meta">
      <a href="/2022/05/12/Redis/" class="article-date">
  <time datetime="2022-05-12T14:25:44.013Z" itemprop="datePublished">2022-05-12</time>
</a> 
  <div class="article-category">
    <a class="article-category-link" href="/categories/Redis/">Redis</a>
  </div>
   
    </div>
      
    <div class="article-entry" itemprop="articleBody">
       
  <h3 id="Redis"><a href="#Redis" class="headerlink" title="Redis"></a><strong>Redis</strong></h3><p><em>远程字典服务</em></p>
<ol>
<li><p>非关系型数据库(NoSQL)</p>
<p>不仅仅是sql</p>
<p>在web2.0时代之前的关系型数据库难以应付高并发</p>
<p>nosql是一种细粒度的缓存，性能会比较高</p>
<p>数据类型是多样型的（不需要事先设计数据库，随取随用）</p>
</li>
<li><p>Map&lt;String,String&gt; map;使用键值对来控制</p>
</li>
</ol>
<h3 id="Redis能干啥？"><a href="#Redis能干啥？" class="headerlink" title="Redis能干啥？"></a>Redis能干啥？</h3><ol>
<li>内存存储，持久化，内存中是断电即失</li>
</ol>
<h3 id="安装Redis"><a href="#安装Redis" class="headerlink" title="安装Redis"></a>安装Redis</h3><ol>
<li><p>下载redis(若版本较高，安装到linux需要升级gcc)</p>
<p>升级gcc</p>
<p>sudo yum install centos-release-scl</p>
<p>sudo yum install devtoolset-7-gcc*</p>
<p>scl enable devtoolset-7 bash</p>
<p>这种只是临时的退出linux之后还是原来的gcc版本</p>
<p>echo “source &#x2F;opt&#x2F;rh&#x2F;{对应的redis文件}&#x2F;enable” &gt;&gt;&#x2F;etc&#x2F;profile</p>
</li>
<li><p>利用上传工具上传到linux，这里用的是Xftp</p>
</li>
<li><p>将redis压缩包移到&#x2F;opt目录下</p>
<p>mv redis文件 目标地址</p>
<p>cd 目标地址</p>
</li>
<li><p>解压redis压缩包</p>
<p>tar -zxvf redis文件</p>
</li>
<li><p>进入redis文件内部</p>
</li>
<li><p>安装c++环境(redis是基于c++的)</p>
<p>yum install gcc-c++</p>
</li>
<li><p>make(编译)</p>
<p>把需要的文件全部配上</p>
</li>
<li><p>make install(安装)</p>
</li>
<li><p>安装目录(cd &#x2F;usr&#x2F;local&#x2F;bin)</p>
<p><img src="C:\Users\19651\AppData\Roaming\Typora\typora-user-images\image-20220511163649719.png" alt="image-20220511163649719"></p>
</li>
<li><p>将redis配置文件，复制到当前目录下</p>
<p>mkdir zconfig</p>
<p>cp &#x2F;opt&#x2F;redis-7.0.0&#x2F;redis.conf zconfig</p>
<p><img src="C:\Users\19651\AppData\Roaming\Typora\typora-user-images\image-20220511164320523.png" alt="image-20220511164320523"></p>
</li>
<li><p>redis默认不是后台启动的</p>
<p>进入redis.conf</p>
<p><img src="C:\Users\19651\AppData\Roaming\Typora\typora-user-images\image-20220511164630556.png" alt="image-20220511164630556"></p>
</li>
<li><p>运行redis</p>
<p>redis-server zconfig&#x2F;redis.conf</p>
<p>redis-cli -p 6379(使用redis客户端连接)</p>
<p><img src="C:\Users\19651\AppData\Roaming\Typora\typora-user-images\image-20220511165132959.png" alt="image-20220511165132959"></p>
<p>ping(查看是否接通)</p>
</li>
<li><p>退出redis</p>
<p>shutdown</p>
<p>exit</p>
</li>
</ol>
<h3 id="Redis工具"><a href="#Redis工具" class="headerlink" title="Redis工具"></a>Redis工具</h3><ol>
<li><p>redis-benchmark是一个压力测试工具</p>
<p>redis-benchmark -h localhost -p 6379 -c 50 -n 10000</p>
<table>
<thead>
<tr>
<th align="left">序号</th>
<th align="left">选项</th>
<th align="left">描述</th>
<th align="left">默认值</th>
</tr>
</thead>
<tbody><tr>
<td align="left">1</td>
<td align="left">-h</td>
<td align="left">指定redis server 主机名</td>
<td align="left">localhost</td>
</tr>
<tr>
<td align="left">2</td>
<td align="left">-p</td>
<td align="left">指定redis 服务端口</td>
<td align="left">6379</td>
</tr>
<tr>
<td align="left">3</td>
<td align="left">-s</td>
<td align="left">指定服务器socket</td>
<td align="left"></td>
</tr>
<tr>
<td align="left">4</td>
<td align="left">-c</td>
<td align="left">指定并发连接数</td>
<td align="left">50</td>
</tr>
<tr>
<td align="left">5</td>
<td align="left">-n</td>
<td align="left">指定请求数</td>
<td align="left">10000</td>
</tr>
<tr>
<td align="left">6</td>
<td align="left">-d</td>
<td align="left">以字节形式指定SET&#x2F;GET值的数值大小</td>
<td align="left">2</td>
</tr>
<tr>
<td align="left">7</td>
<td align="left">-k</td>
<td align="left">1&#x3D;keepalive 0&#x3D;reconnect</td>
<td align="left">1</td>
</tr>
<tr>
<td align="left">8</td>
<td align="left">-r</td>
<td align="left">SET&#x2F;GET&#x2F;INCR使用随机key, SADD使用随机值</td>
<td align="left"></td>
</tr>
<tr>
<td align="left">9</td>
<td align="left">-P</td>
<td align="left">通过管道传输<numreq>请求</td>
<td align="left">1</td>
</tr>
<tr>
<td align="left">10</td>
<td align="left">-q</td>
<td align="left">强制退出redis.仅显示query&#x2F;sec值</td>
<td align="left"></td>
</tr>
<tr>
<td align="left">11</td>
<td align="left">-csv</td>
<td align="left">以csv格式输出</td>
<td align="left"></td>
</tr>
<tr>
<td align="left">12</td>
<td align="left">-l</td>
<td align="left">生成循环 永久执行测试</td>
<td align="left"></td>
</tr>
<tr>
<td align="left">13</td>
<td align="left">-t</td>
<td align="left">仅运行以逗号分隔的测试命令列表</td>
<td align="left"></td>
</tr>
<tr>
<td align="left">14</td>
<td align="left">-I</td>
<td align="left">Idle模式,仅打开N个idle连接并等待</td>
<td align="left"></td>
</tr>
</tbody></table>
<p><img src="C:\Users\19651\AppData\Roaming\Typora\typora-user-images\image-20220511175118539.png" alt="image-20220511175118539"></p>
</li>
</ol>
<h3 id="Redis基本知识说明"><a href="#Redis基本知识说明" class="headerlink" title="Redis基本知识说明"></a>Redis基本知识说明</h3><ol>
<li><p>redis默认有16个数据库</p>
<p>默认使用的是第0个</p>
<p>select num 切换数据库</p>
</li>
<li><p>~~~bash<br>127.0.0.1:6379&gt; select 0 #切换数据库0-15<br>OK<br>127.0.0.1:6379&gt; dbsize #当前数据库大小<br>(integer) 5<br>127.0.0.1:6379&gt; keys * #查看当前数据库所有的键值</p>
<ol>
<li>“myhash”</li>
<li>“name”</li>
<li>“counter:<strong>rand_int</strong>“</li>
<li>“key:<strong>rand_int</strong>“</li>
<li>“mylist”<br>127.0.0.1:6379&gt; flushdb #清空当前数据库<br>127.0.0.1:6379[1]&gt; flushall #清空所有数据库<br>127.0.0.1:6379[1]&gt; exists key #查看key是否存在<br>127.0.0.1:6379&gt; move name 1 #移动数据到第几个数据库<br>127.0.0.1:6379&gt; expire he 10 #设置过期时间为10秒<br>.1:6379&gt; ttl he #查看元素还剩多长时间过期<br>127.0.0.1:6379&gt; del he #删除当前元素<br>127.0.0.1:6379&gt; type na #查看当前元素什么类型<figure class="highlight accesslog"><table><tr><td class="code"><pre><code class="hljs accesslog"><br><span class="hljs-number">3</span>. redis是单线程的<br><br>   Redis是很快的，官方表示，Redis是基于内存操作，CPU不是Redis性能瓶颈，Redis的瓶颈是根据机器的内存和网络带宽，既然可以使用单线程来实现，就使用单线程了<br><br>   cpu&gt;内存&gt;硬盘<br><br>   多线程(cpu上下文会切换) 不一定会比单线程效率高<br><br>   核心：redis是将所有的数据全部放在内存中的，所有说使用单线程去操作效率就是最高的，多线程(cpu会上下文切换，耗时的操作)对于内存系统来说，如果没有上下文切换效率就是最高的，每次读写都是在一个cpu上的，在内存情况下，这个就是最佳方案<br><br><span class="hljs-number">4</span>. Redis五大数据类型<br><br>   Redis是一个开源的，内存中的数据结构存储系统，它可以用作**数据库**，**缓存**和**消息中间件MQ**<br><br>   Redis-key<br><br>   String<br><br>   List<br><br>   Set<br><br>   Hash<br><br>   Zset<br><br><span class="hljs-number">5</span>. 三种基本数据类型<br><br>   geospatial<br><br>   hyperloglog<br><br>   bitmaps<br><br>### String字符串类型详解<br><br>~~~bash<br><span class="hljs-number">127.0.0.1:6379</span>&gt; dbsize<br>(integer) <span class="hljs-number">1</span><br><span class="hljs-number">127.0.0.1:6379</span>&gt; keys *<br><span class="hljs-number">1</span>) <span class="hljs-string">&quot;na&quot;</span><br><span class="hljs-number">127.0.0.1:6379</span>&gt; append na whe # 往na后添加字符串，如果字符串不存在就相当于set key<br><span class="hljs-number">127.0.0.1:6379</span>&gt; strlen na #获取na的长度<br><span class="hljs-number">127.0.0.1:6379</span>&gt; set num <span class="hljs-number">1</span><br>OK<br><span class="hljs-number">127.0.0.1:6379</span>&gt; type num<br>string<br><span class="hljs-number">127.0.0.1:6379</span>&gt; incr num #一次增加一个<br>(integer) <span class="hljs-number">2</span><br><span class="hljs-number">127.0.0.1:6379</span>&gt; incrby num <span class="hljs-number">10</span> #一次增加n个<br>(integer) <span class="hljs-number">12</span><br><span class="hljs-number">127.0.0.1:6379</span>&gt; get num<br><span class="hljs-string">&quot;12&quot;</span><br><span class="hljs-number">127.0.0.1:6379</span>&gt; decr num #一次减少一个<br>(integer) <span class="hljs-number">11</span><br><span class="hljs-number">127.0.0.1:6379</span>&gt; decrby num <span class="hljs-number">10</span> #一次减少n个<br>(integer) <span class="hljs-number">1</span><br><span class="hljs-number">127.0.0.1:6379</span>&gt; getrange title <span class="hljs-number">0</span> <span class="hljs-number">2</span> #截取字符串显示<br><span class="hljs-string">&quot;hel&quot;</span><br><span class="hljs-number">127.0.0.1:6379</span>&gt; getrange title <span class="hljs-number">0</span> -<span class="hljs-number">1</span> #全部输出<br><span class="hljs-string">&quot;hello,world&quot;</span><br><span class="hljs-number">127.0.0.1:6379</span>&gt; setrange title <span class="hljs-number">1</span> push #替换，相当于replease<br>(integer) <span class="hljs-number">11</span><br><span class="hljs-number">127.0.0.1:6379</span>&gt; get title<br><span class="hljs-string">&quot;hpush,world&quot;</span><br>###################################################<br><span class="hljs-number">127.0.0.1:6379</span>&gt; setex title2 <span class="hljs-number">10</span> hello,world #<span class="hljs-number">10</span>秒后过期<br>OK<br><span class="hljs-number">127.0.0.1:6379</span>&gt; ttl title2<br>(integer) <span class="hljs-number">4</span><br><span class="hljs-number">127.0.0.1:6379</span>&gt; setnx title2 jelly #如果key不存在添加成功，存在添加失败(常用在分布式锁中)<br>(integer) <span class="hljs-number">0</span><br><span class="hljs-number">127.0.0.1:6379</span>&gt; mset k1 v1 k2 v2 k3 v4#同时设置多个值<br>OK<br><span class="hljs-number">127.0.0.1:6379</span>&gt; mget k1 k2 k3#同时获取多个值<br><span class="hljs-number">1</span>) <span class="hljs-string">&quot;v1&quot;</span><br><span class="hljs-number">2</span>) <span class="hljs-string">&quot;v2&quot;</span><br><span class="hljs-number">3</span>) <span class="hljs-string">&quot;v4&quot;</span><br><span class="hljs-number">127.0.0.1:6379</span>&gt; msetnx k5 v5 k7 v7#不存在时设置成功，原子操作<br>(integer) <span class="hljs-number">1</span><br>##对象<br><span class="hljs-number">127.0.0.1:6379</span>&gt; set user:<span class="hljs-number">1</span> &#123;name:zs,age:<span class="hljs-number">15</span>&#125; #获取key之后类似于json数据<br>OK<br><span class="hljs-number">127.0.0.1:6379</span>&gt; mset user:<span class="hljs-number">1</span>:name zs user:<span class="hljs-number">1</span>:age <span class="hljs-number">15</span><br><span class="hljs-number">127.0.0.1:6379</span>&gt; getset user:<span class="hljs-number">1</span>:name lb#将给定key的值设置为value并返回旧值<br><span class="hljs-string">&quot;zs&quot;</span><br></code></pre></td></tr></table></figure></li>
</ol>
</li>
</ol>
<h3 id="List类型详解"><a href="#List类型详解" class="headerlink" title="List类型详解"></a>List类型详解</h3><figure class="highlight bash"><table><tr><td class="code"><pre><code class="hljs bash"><span class="hljs-comment">#头插，顺序是反的</span><br>127.0.0.1:6379&gt; lpush list list1<br>(<span class="hljs-built_in">integer</span>) 1<br>127.0.0.1:6379&gt; lpush list list2<br>(<span class="hljs-built_in">integer</span>) 2<br>127.0.0.1:6379&gt; lrange list 0 -1<br>1) <span class="hljs-string">&quot;list2&quot;</span><br>2) <span class="hljs-string">&quot;list1&quot;</span><br>127.0.0.1:6379&gt; lrange list 0 0<br>1) <span class="hljs-string">&quot;list2&quot;</span><br><br><span class="hljs-comment">#尾插，顺序是正的</span><br>127.0.0.1:6379&gt; rpush list list1<br>(<span class="hljs-built_in">integer</span>) 1<br>127.0.0.1:6379&gt; rpush list list2<br>(<span class="hljs-built_in">integer</span>) 2<br>127.0.0.1:6379&gt; rpush list list3<br>(<span class="hljs-built_in">integer</span>) 3<br>127.0.0.1:6379&gt; lrange list 0 -1<br>1) <span class="hljs-string">&quot;list1&quot;</span><br>2) <span class="hljs-string">&quot;list2&quot;</span><br>3) <span class="hljs-string">&quot;list3&quot;</span><br>127.0.0.1:6379&gt; lpop list<span class="hljs-comment">#左边移除</span><br><span class="hljs-string">&quot;list1&quot;</span><br>127.0.0.1:6379&gt; rpop list<span class="hljs-comment">#右边移除</span><br><span class="hljs-string">&quot;list3&quot;</span><br>127.0.0.1:6379&gt; lindex list 0 <span class="hljs-comment">#从左边获取下标为0的元素</span><br><span class="hljs-string">&quot;one&quot;</span><br>127.0.0.1:6379&gt; llen list <span class="hljs-comment">#获取list长度</span><br>(<span class="hljs-built_in">integer</span>) 3<br>127.0.0.1:6379&gt; lrem list 1 three<span class="hljs-comment">#删除一个list集合中的 three元素</span><br>(<span class="hljs-built_in">integer</span>) 1<br>127.0.0.1:6379&gt; ltrim list 1 2<span class="hljs-comment">#截取list中间的元素，两边删除</span><br>OK<br>127.0.0.1:6379&gt; lrange list 0 -1<br>1) <span class="hljs-string">&quot;two&quot;</span><br>2) <span class="hljs-string">&quot;three&quot;</span><br>127.0.0.1:6379&gt; rpoplpush list newlist<span class="hljs-comment">#删除最后一个数据并添加到newlist的第一个数据</span><br><span class="hljs-string">&quot;three&quot;</span><br>127.0.0.1:6379&gt; lset list 0 hello <span class="hljs-comment">#替换list中第0个元素为hello。如果不存在就会报错</span><br>OK<br>127.0.0.1:6379&gt; linsert list before two one<span class="hljs-comment">#在list集合中two的前面插入one元素</span><br>(<span class="hljs-built_in">integer</span>) 4<br><br></code></pre></td></tr></table></figure>

<h3 id="Set类型详解"><a href="#Set类型详解" class="headerlink" title="Set类型详解"></a>Set类型详解</h3><figure class="highlight bash"><table><tr><td class="code"><pre><code class="hljs bash">127.0.0.1:6379&gt; sadd myset hello<span class="hljs-comment">#往set类型的myset中添加元素</span><br>(<span class="hljs-built_in">integer</span>) 1<br>127.0.0.1:6379&gt; sadd myset ahui<br>(<span class="hljs-built_in">integer</span>) 1<br>127.0.0.1:6379&gt; smembers myset<span class="hljs-comment">#查询所有元素</span><br>1) <span class="hljs-string">&quot;ahui&quot;</span><br>2) <span class="hljs-string">&quot;hello&quot;</span><br>127.0.0.1:6379&gt; sismember myset ahui<span class="hljs-comment">#查询set类型的集合中是否存在该值</span><br>(<span class="hljs-built_in">integer</span>) 1<br>127.0.0.1:6379&gt; scard myset<span class="hljs-comment">#查询myset集合中有几个元素</span><br>(<span class="hljs-built_in">integer</span>) 2<br>127.0.0.1:6379&gt; srem myset hello<span class="hljs-comment">#删除myset集合中的hello元素</span><br>(<span class="hljs-built_in">integer</span>) 1<br>127.0.0.1:6379&gt; srandmember myset<span class="hljs-comment">#获取myset中随机的元素</span><br><span class="hljs-string">&quot;hello</span><br><span class="hljs-string">127.0.0.1:6379&gt; spop myset#随机删除元素</span><br><span class="hljs-string">&quot;</span>ahui<span class="hljs-string">&quot;</span><br><span class="hljs-string">127.0.0.1:6379&gt; smove myset myset2 hello#移动元素，将myset中的hello元素移到myset2中</span><br><span class="hljs-string">(integer) 1</span><br><span class="hljs-string">127.0.0.1:6379&gt; sdiff set1 set2#查找set1中set2没有的元素</span><br><span class="hljs-string">1) &quot;</span>b<span class="hljs-string">&quot;</span><br><span class="hljs-string">2) &quot;</span>a<span class="hljs-string">&quot;</span><br><span class="hljs-string">127.0.0.1:6379&gt; sunion set1 set2#查找set1和set2的并集</span><br><span class="hljs-string">1) &quot;</span>a<span class="hljs-string">&quot;</span><br><span class="hljs-string">2) &quot;</span>c<span class="hljs-string">&quot;</span><br><span class="hljs-string">3) &quot;</span>b<span class="hljs-string">&quot;</span><br><span class="hljs-string">4) &quot;</span>d<span class="hljs-string">&quot;</span><br><span class="hljs-string">5) &quot;</span>e<span class="hljs-string">&quot;</span><br><span class="hljs-string">127.0.0.1:6379&gt; sinter set1 set2#查找set1和set2的交集</span><br><span class="hljs-string">1) &quot;</span>c<span class="hljs-string">&quot;</span><br><span class="hljs-string"></span><br></code></pre></td></tr></table></figure>

<h3 id="Hash-哈希"><a href="#Hash-哈希" class="headerlink" title="Hash(哈希)"></a>Hash(哈希)</h3><p>Map集合，key-Map形式</p>
<p>类似于String类型</p>
<p>hash变更的数据user name，age，尤其是用户信息之类，经常变动的信息！hash更适合于对象的存储，String跟适合字符的存储</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><code class="hljs bash">127.0.0.1:6379&gt; hset myhash f1 ahui f2 v2<span class="hljs-comment">#设置hash值Map形式</span><br>(<span class="hljs-built_in">integer</span>) 2<br>127.0.0.1:6379&gt; hget myhash f1<span class="hljs-comment">#获取值</span><br><span class="hljs-string">&quot;ahui&quot;</span><br>127.0.0.1:6379&gt; hmget myhash f1 f2<span class="hljs-comment">#获取多个值</span><br>1) <span class="hljs-string">&quot;ahui&quot;</span><br>2) <span class="hljs-string">&quot;v2&quot;</span><br>127.0.0.1:6379&gt; hgetall myhash<span class="hljs-comment">#获取所有的值</span><br>1) <span class="hljs-string">&quot;f1&quot;</span><br>2) <span class="hljs-string">&quot;ahui&quot;</span><br>3) <span class="hljs-string">&quot;f2&quot;</span><br>4) <span class="hljs-string">&quot;v2&quot;</span><br>127.0.0.1:6379&gt; hdel myhash f1<span class="hljs-comment">#删除hash值</span><br>(<span class="hljs-built_in">integer</span>) 1<br>127.0.0.1:6379&gt; hgetall myhash<br>1) <span class="hljs-string">&quot;f2&quot;</span><br>2) <span class="hljs-string">&quot;v2&quot;</span><br>127.0.0.1:6379&gt; hlen myhash<span class="hljs-comment">#获取有多少个值</span><br>(<span class="hljs-built_in">integer</span>) 1<br>127.0.0.1:6379&gt; hkeys myhash<span class="hljs-comment">#获取所有的key</span><br>1) <span class="hljs-string">&quot;f2&quot;</span><br>127.0.0.1:6379&gt; hvals myhash<span class="hljs-comment">#获取所有的值</span><br>1) <span class="hljs-string">&quot;v2&quot;</span><br>127.0.0.1:6379&gt; hincrby mybash f3 1<span class="hljs-comment">#增加1</span><br>(<span class="hljs-built_in">integer</span>) 6<br>127.0.0.1:6379&gt; hincrby mybash f3 -1<span class="hljs-comment">#减1</span><br>(<span class="hljs-built_in">integer</span>) 5<br>127.0.0.1:6379&gt; hsetnx mybash f3 he<span class="hljs-comment">#如果不存在时新增</span><br>(<span class="hljs-built_in">integer</span>) 0<br><br></code></pre></td></tr></table></figure>

<h3 id="Zset有序集合"><a href="#Zset有序集合" class="headerlink" title="Zset有序集合"></a>Zset有序集合</h3><p>ZRANGEBYSCORE是按照score排列</p>
<p>zrange是按照索引排列</p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/jfqqqqq/article/details/102858508?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522165236460416781685342181%2522%252C%2522scm%2522%253A%252220140713.130102334..%2522%257D&request_id=165236460416781685342181&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduend~default-2-102858508-null-null.142%5Ev9%5Epc_search_result_control_group,157%5Ev4%5Econtrol&utm_term=zrange%E5%92%8Czrangebyscore%E5%8C%BA%E5%88%AB&spm=1018.2226.3001.4187">zrange和zrangebyscore区别</a></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><code class="hljs bash">127.0.0.1:6379&gt; zadd myset 1 one<span class="hljs-comment">#添加一个元素中间标志位起到排序作用</span><br>(<span class="hljs-built_in">integer</span>) 1<br>127.0.0.1:6379&gt; zadd myset 2 two<br>(<span class="hljs-built_in">integer</span>) 1<br>127.0.0.1:6379&gt; zadd myset 3 three<br>(<span class="hljs-built_in">integer</span>) 1<br>127.0.0.1:6379&gt; zrange myset 0 -1<span class="hljs-comment">#查询所有元素</span><br>1) <span class="hljs-string">&quot;one&quot;</span><br>2) <span class="hljs-string">&quot;two&quot;</span><br>3) <span class="hljs-string">&quot;three&quot;</span><br><span class="hljs-comment">#ZRANGEBYSCORE myset 最小值 最大值</span><br>127.0.0.1:6379&gt; ZRANGEBYSCORE myset -inf +inf<span class="hljs-comment">#根据score排序</span><br>1) <span class="hljs-string">&quot;one&quot;</span><br>2) <span class="hljs-string">&quot;two&quot;</span><br>3) <span class="hljs-string">&quot;three&quot;</span><br>4) <span class="hljs-string">&quot;four&quot;</span><br>5) <span class="hljs-string">&quot;five&quot;</span><br>127.0.0.1:6379&gt; zrem myset two<span class="hljs-comment">#删除zset集合中的two元素</span><br>(<span class="hljs-built_in">integer</span>) 1<br>127.0.0.1:6379&gt; zcard myset<span class="hljs-comment">#查看zset集合中有多少元素</span><br>(<span class="hljs-built_in">integer</span>) 4<br>127.0.0.1:6379&gt; ZREVRANGE myset 0 -1<span class="hljs-comment">#降序排列</span><br>1) <span class="hljs-string">&quot;five&quot;</span><br>2) <span class="hljs-string">&quot;four&quot;</span><br>3) <span class="hljs-string">&quot;three&quot;</span><br>4) <span class="hljs-string">&quot;one&quot;</span><br>127.0.0.1:6379&gt; zcount myset 4 6<span class="hljs-comment">#获取指定区间的成员数量</span><br>(<span class="hljs-built_in">integer</span>) 3<br><br></code></pre></td></tr></table></figure>

 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Redis%E4%BA%94%E5%A4%A7%E5%9F%BA%E6%9C%AC%E7%B1%BB%E5%9E%8B/" rel="tag">Redis五大基本类型</a></li></ul>

    </footer>
  </div>

   
    
</article>

    
    <article
  id="post-springMvc"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2022/05/04/springMvc/"
    >springMvc</a> 
</h2>
 

      
    </header>
     
    <div class="article-meta">
      <a href="/2022/05/04/springMvc/" class="article-date">
  <time datetime="2022-05-04T14:04:06.813Z" itemprop="datePublished">2022-05-04</time>
</a> 
  <div class="article-category">
    <a class="article-category-link" href="/categories/spring/">spring</a>
  </div>
   
    </div>
      
    <div class="article-entry" itemprop="articleBody">
       
  <p>maven项目创建过慢</p>
<ol>
<li>添加键值对 archetypeCatalog internal</li>
<li>设置阿里镜像</li>
</ol>
<p>springMvc中Dispatcher作用</p>
<p>​	<em>org.springframework.web.servlet.DispatcherServlet</em></p>
<p><img src="C:\Users\19651\AppData\Roaming\Typora\typora-user-images\image-20220109170751482.png" alt="image-20220109170751482"></p>
<figure class="highlight xml"><table><tr><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">web-app</span> <span class="hljs-keyword">PUBLIC</span></span><br><span class="hljs-meta"> <span class="hljs-string">&quot;-//Sun Microsystems, Inc.//DTD Web Application 2.3//EN&quot;</span></span><br><span class="hljs-meta"> <span class="hljs-string">&quot;http://java.sun.com/dtd/web-app_2_3.dtd&quot;</span> &gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">web-app</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">display-name</span>&gt;</span>Archetype Created Web Application<span class="hljs-tag">&lt;/<span class="hljs-name">display-name</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">servlet</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">servlet-name</span>&gt;</span>DispatcherServlet<span class="hljs-tag">&lt;/<span class="hljs-name">servlet-name</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">servlet-class</span>&gt;</span>org.springframework.web.servlet.DispatcherServlet<span class="hljs-tag">&lt;/<span class="hljs-name">servlet-class</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">init-param</span>&gt;</span><br>      <span class="hljs-tag">&lt;<span class="hljs-name">param-name</span>&gt;</span>contextConfigLocation<span class="hljs-tag">&lt;/<span class="hljs-name">param-name</span>&gt;</span><br>      <span class="hljs-tag">&lt;<span class="hljs-name">param-value</span>&gt;</span>classpath:springMvc.xml<span class="hljs-tag">&lt;/<span class="hljs-name">param-value</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">init-param</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">load-on-startup</span>&gt;</span>1<span class="hljs-tag">&lt;/<span class="hljs-name">load-on-startup</span>&gt;</span><br>  <span class="hljs-tag">&lt;/<span class="hljs-name">servlet</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">servlet-mapping</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">servlet-name</span>&gt;</span>DispatcherServlet<span class="hljs-tag">&lt;/<span class="hljs-name">servlet-name</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">url-pattern</span>&gt;</span>/<span class="hljs-tag">&lt;/<span class="hljs-name">url-pattern</span>&gt;</span><br>  <span class="hljs-tag">&lt;/<span class="hljs-name">servlet-mapping</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">web-app</span>&gt;</span><br></code></pre></td></tr></table></figure>

<p>DispatcherServlet：前端控制器</p>
<p>​									用户请求到达前端控制器，它就相当于mvc模式中的c，dispatcherServlet是整个流程控制的中心，由其他调用其他组件处理用户的请求，dispatcherServlet的存在降低了组件之间的耦合性。</p>
<p>HandlerMapping：处理器映射器</p>
<p>​									HandlerMapping负责根据用户请求找到Handler即处理器，SpringMvc提供了不同的映射器实现不同的映射方式，例如：配置文件方式，实现接口方式，注解方式等。</p>
<p>HandlerAdapter：处理器适配器</p>
<p>​									通过HandlerAdapter对处理器进行执行，这是适配器模式的应用，通过扩展适配器可以对更多类型的处理器进行执行。</p>
<p>View：视图</p>
<p>​									SpringMVC框架提供了更多的View视图类型的支持，包括：jstlView，freemarkerView，pdfView等，我们最常用的视图就是jsp。</p>
<p> &lt;<a target="_blank" rel="noopener" href="https://so.csdn.net/so/search?q=mvc">mvc</a>:annotation-driven &#x2F;&gt;是一种简写形式，完全可以手动配置替代这种简写形式，简写形式可以让初学者快速应用默认配置方案</p>
<p>springMvc注解</p>
<p>@RequestMapping(“&#x2F;springmvc”)：映射路径</p>
<p>params：表示传递过来的必须有username，id这个数据否则不会匹配</p>
<p>headers：要求必须含有对应的请求头才能匹配</p>
<p>method：以什么方式请求才能匹配到</p>
<figure class="highlight java"><table><tr><td class="code"><pre><code class="hljs Java"><span class="hljs-meta">@RequestMapping(value = &quot;/springmvc&quot;,params = &#123;&quot;username&quot;,&quot;id&quot;&#125;,headers = &#123;&quot;Accept&quot;&#125;,method = &#123;RequestMethod.POST&#125;)</span><br>    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">springMvcF</span><span class="hljs-params">()</span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;hello&quot;</span>;<br>    &#125;<br></code></pre></td></tr></table></figure>

<p>集合类型参数</p>
<figure class="highlight jsp"><table><tr><td class="code"><pre><code class="hljs JSP">&lt;form action=<span class="hljs-string">&quot;springmvc&quot;</span> method=<span class="hljs-string">&quot;post&quot;</span>&gt;<br>    用户名：&lt;input type=<span class="hljs-string">&quot;text&quot;</span> name=<span class="hljs-string">&quot;username&quot;</span>&gt;&lt;br&gt;<br>    密码：&lt;input type=<span class="hljs-string">&quot;text&quot;</span> name=<span class="hljs-string">&quot;password&quot;</span>&gt;&lt;br&gt;<br>    list:&lt;input type=<span class="hljs-string">&quot;test&quot;</span> name=<span class="hljs-string">&quot;adminList[0].username&quot;</span>&gt;&lt;br&gt;<br>    list:&lt;input type=<span class="hljs-string">&quot;test&quot;</span> name=<span class="hljs-string">&quot;adminList[0].password&quot;</span>&gt;&lt;br&gt;<br><br>    list:&lt;input type=<span class="hljs-string">&quot;test&quot;</span> name=<span class="hljs-string">&quot;adminMap[&#x27;map&#x27;].username&quot;</span>&gt;&lt;br&gt;<br>    list:&lt;input type=<span class="hljs-string">&quot;test&quot;</span> name=<span class="hljs-string">&quot;adminMap[&#x27;map&#x27;].password&quot;</span>&gt;&lt;br&gt;<br>    &lt;input type=<span class="hljs-string">&quot;submit&quot;</span> value=<span class="hljs-string">&quot;提交&quot;</span>&gt;<br>&lt;/form&gt;<br></code></pre></td></tr></table></figure>

<p>springmvc拦截静态资源问题</p>
<p>由于在web.xml中配置了全局过滤，所以在引用js文件时同样会被拦截，只需在springMvc.xml中配置调用该文件目录时正常调用即可</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">mvc:resources</span> <span class="hljs-attr">location</span>=<span class="hljs-string">&quot;/js/&quot;</span> <span class="hljs-attr">mapping</span>=<span class="hljs-string">&quot;/js/**&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">mvc:resources</span>&gt;</span><br></code></pre></td></tr></table></figure>

<p>前端向后端传入json数据后端以对象形式接收</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>com.fasterxml.jackson.core<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>jackson-core<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>2.9.2<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>com.fasterxml.jackson.core<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>jackson-databind<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>2.9.2<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br></code></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="code"><pre><code class="hljs js">$(<span class="hljs-string">&quot;#in1&quot;</span>).<span class="hljs-title function_">click</span>(<span class="hljs-keyword">function</span> (<span class="hljs-params"></span>)&#123;<br>    <span class="hljs-title function_">alert</span>(<span class="hljs-string">&quot;点击效果&quot;</span>)<br>    $.<span class="hljs-title function_">ajax</span>(&#123;<br>        <span class="hljs-attr">url</span>:<span class="hljs-string">&quot;springmvcAjaxs&quot;</span>,<br>        <span class="hljs-attr">type</span>:<span class="hljs-string">&quot;post&quot;</span>,<br>        <span class="hljs-attr">contentType</span>:<span class="hljs-string">&quot;application/json;charset=utf-8&quot;</span>,<br>        <span class="hljs-attr">dataType</span>:<span class="hljs-string">&quot;json&quot;</span>,<span class="hljs-comment">//返回数据类型</span><br>        <span class="hljs-attr">data</span>:<span class="hljs-string">&#x27;&#123;&quot;username&quot;:&quot;111&quot;,&quot;password&quot;:&quot;张三&quot;&#125;&#x27;</span>,<br>        <span class="hljs-attr">success</span>:<span class="hljs-keyword">function</span> (<span class="hljs-params">e</span>)&#123;<br>            <span class="hljs-title function_">alert</span>(e.<span class="hljs-property">username</span>+<span class="hljs-string">&quot;:正确&quot;</span>)<br>        &#125;,<span class="hljs-attr">error</span>:<span class="hljs-keyword">function</span> (<span class="hljs-params">e</span>)&#123;<br>            <span class="hljs-title function_">alert</span>(e.<span class="hljs-property">password</span>+<span class="hljs-string">&quot;:错误&quot;</span>)<br>        &#125;<br><br>    &#125;)<br>&#125;)<br></code></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@RequestMapping(&quot;/springmvcAjaxs&quot;)</span><br><span class="hljs-keyword">public</span> <span class="hljs-meta">@ResponseBody</span> UserInfo <span class="hljs-title function_">springmvcAja</span><span class="hljs-params">(<span class="hljs-meta">@RequestBody</span> UserInfo userInfo)</span>&#123;<br>    System.out.println(<span class="hljs-string">&quot;后台执行了&quot;</span>);<br><br>    System.out.println(userInfo.toString());<br>    <span class="hljs-keyword">return</span> userInfo;<br>&#125;<br></code></pre></td></tr></table></figure>



<figure class="highlight java"><table><tr><td class="code"><pre><code class="hljs java">request.getSession().getServletContext().getRealPath(<span class="hljs-string">&quot;/uploads/&quot;</span>)<br></code></pre></td></tr></table></figure>

<p>request.get<a target="_blank" rel="noopener" href="https://so.csdn.net/so/search?q=Session">Session</a>().getServletContext() 获取的是Servlet容器对象，相当于tomcat容器了。getRealPath(“&#x2F;“) 获取实际路径，“&#x2F;”指代项目根目录，所以代码返回的是项目在容器中的实际发布运行的根路径</p>
<p>springMvc上传文件</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>commons-io<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>commons-io<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>2.5<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>commons-fileupload<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>commons-fileupload<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>1.3.1<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.apache.commons<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>commons-lang3<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>获取随机数<br>  <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>3.1<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br></code></pre></td></tr></table></figure>

<figure class="highlight jsp"><table><tr><td class="code"><pre><code class="hljs jsp">&lt;form action=<span class="hljs-string">&quot;FileUp&quot;</span> method=<span class="hljs-string">&quot;post&quot;</span> enctype=<span class="hljs-string">&quot;multipart/form-data&quot;</span>&gt;<br>    &lt;input type=<span class="hljs-string">&quot;file&quot;</span> value=<span class="hljs-string">&quot;选择文件&quot;</span> name=<span class="hljs-string">&quot;upload&quot;</span>&gt;<br>    &lt;input type=<span class="hljs-string">&quot;submit&quot;</span> value=<span class="hljs-string">&quot;提交&quot;</span>&gt;<br>&lt;/form&gt;<br></code></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@RequestMapping(&quot;/FileUp&quot;)</span><br>    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">FileUp</span><span class="hljs-params">(HttpServletRequest request, MultipartFile upload)</span> <span class="hljs-keyword">throws</span> IOException &#123;<br>        <span class="hljs-type">String</span> <span class="hljs-variable">realPath</span> <span class="hljs-operator">=</span> request.getSession().getServletContext().getRealPath(File.separator+<span class="hljs-string">&quot;uploads&quot;</span>+File.separator);<br>        <span class="hljs-comment">//        获取原始文件名称</span><br>        String orignl=upload.getOriginalFilename();<br><span class="hljs-comment">//        获取图片后缀</span><br>        <span class="hljs-type">String</span> <span class="hljs-variable">extension</span> <span class="hljs-operator">=</span> FilenameUtils.getExtension(orignl);<br>        File file=<span class="hljs-keyword">new</span> <span class="hljs-title class_">File</span>(realPath);<br>        <span class="hljs-keyword">if</span>(!file.exists())&#123;<br><span class="hljs-comment">//            如果文件不存在则创建该目录</span><br>            file.mkdir();<br>        &#125;<br>        String fileName=System.currentTimeMillis()+Math.ceil(Math.random()*<span class="hljs-number">100000</span>) +<span class="hljs-string">&quot;_pic.&quot;</span>+extension;<br>        upload.transferTo(<span class="hljs-keyword">new</span> <span class="hljs-title class_">File</span>(realPath,fileName));<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;success&quot;</span>;<br>    &#125;<br></code></pre></td></tr></table></figure>

<figure class="highlight xml"><table><tr><td class="code"><pre><code class="hljs xml">    //使用配置好的解析器  注意这里id不能改<br>    <span class="hljs-tag">&lt;<span class="hljs-name">bean</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;multipartResolver&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;org.springframework.web.multipart.commons.CommonsMultipartResolver&quot;</span>&gt;</span><br><span class="hljs-comment">&lt;!--        上传最大文件大小10M 这里字节表示--&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;maxUploadSize&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;10485760&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">bean</span>&gt;</span><br></code></pre></td></tr></table></figure>

<p>自定义异常处理器(报异常直接显示错误界面)</p>
<figure class="highlight java"><table><tr><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> org.springframework.web.servlet.ModelAndView;<br><br><span class="hljs-keyword">import</span> javax.servlet.http.HttpServletRequest;<br><span class="hljs-keyword">import</span> javax.servlet.http.HttpServletResponse;<br><span class="hljs-keyword">import</span> java.lang.reflect.InvocationHandler;<br><span class="hljs-keyword">import</span> java.lang.reflect.Method;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">SysExcep</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">HandlerExceptionResolver</span> &#123;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> ModelAndView <span class="hljs-title function_">resolveException</span><span class="hljs-params">(HttpServletRequest httpServletRequest, HttpServletResponse httpServletResponse, Object o, Exception e)</span> &#123;<br>        ModelAndView modelAndView=<span class="hljs-keyword">new</span> <span class="hljs-title class_">ModelAndView</span>();<br>        <span class="hljs-keyword">if</span>(e <span class="hljs-keyword">instanceof</span> MyException)&#123;<br>            MyException myException=(MyException)e;<br>            modelAndView.addObject(<span class="hljs-string">&quot;errorMsg&quot;</span>,myException.getErrorMsg());<br>        &#125;<span class="hljs-keyword">else</span>&#123;<br>            modelAndView.addObject(<span class="hljs-string">&quot;errorMsg&quot;</span>,e);<br>        &#125;<br>        modelAndView.setViewName(<span class="hljs-string">&quot;error&quot;</span>);<br>        <span class="hljs-keyword">return</span> modelAndView;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<figure class="highlight xml"><table><tr><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">bean</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;sysExcep&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;com.mySpringMvc.SysExcep&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">bean</span>&gt;</span><br></code></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.mySpringMvc;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MyException</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Exception</span> &#123;<br>    <span class="hljs-keyword">private</span> String errorMsg;<br><br>    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">getErrorMsg</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> errorMsg;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setErrorMsg</span><span class="hljs-params">(String errorMsg)</span> &#123;<br>        <span class="hljs-built_in">this</span>.errorMsg = errorMsg;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">MyException</span><span class="hljs-params">(String message)</span> &#123;<br>        <span class="hljs-built_in">this</span>.errorMsg = message;<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">toString</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;MyException&#123;&quot;</span> +<br>                <span class="hljs-string">&quot;errorMsg=&#x27;&quot;</span> + errorMsg + <span class="hljs-string">&#x27;\&#x27;&#x27;</span> +<br>                <span class="hljs-string">&#x27;&#125;&#x27;</span>;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@RequestMapping(&quot;/redir&quot;)</span><br>    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">redir</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> MyException &#123;<br>        <span class="hljs-keyword">try</span> &#123;<br>            <span class="hljs-type">int</span> i=<span class="hljs-number">1</span>/<span class="hljs-number">0</span>;<br>        &#125;<span class="hljs-keyword">catch</span> (Exception e)&#123;<br>            e.printStackTrace();<br>            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">MyException</span>(<span class="hljs-string">&quot;除0异常&quot;</span>);<br>        &#125;<br><br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;hello&quot;</span>;<br>    &#125;<br></code></pre></td></tr></table></figure>

<p>springMvc拦截器使用</p>
<p><img src="C:\Users\19651\AppData\Roaming\Typora\typora-user-images\image-20220113172216967.png" alt="image-20220113172216967"></p>
<figure class="highlight java"><table><tr><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.mySpringMvc;<br><br><span class="hljs-keyword">import</span> org.springframework.web.servlet.HandlerInterceptor;<br><span class="hljs-keyword">import</span> org.springframework.web.servlet.ModelAndView;<br><br><span class="hljs-keyword">import</span> javax.servlet.http.HttpServletRequest;<br><span class="hljs-keyword">import</span> javax.servlet.http.HttpServletResponse;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">HandlerInt</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">HandlerInterceptor</span> &#123;<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">preHandle</span><span class="hljs-params">(HttpServletRequest request, HttpServletResponse response, Object handler)</span> <span class="hljs-keyword">throws</span> Exception &#123;<br>        System.out.println(<span class="hljs-string">&quot;拦截器---前&quot;</span>);<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<span class="hljs-comment">//true 放行 ，false不放行</span><br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">postHandle</span><span class="hljs-params">(HttpServletRequest request, HttpServletResponse response, Object handler, ModelAndView modelAndView)</span> <span class="hljs-keyword">throws</span> Exception &#123;<br>        System.out.println(<span class="hljs-string">&quot;拦截器---后&quot;</span>);<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">afterCompletion</span><span class="hljs-params">(HttpServletRequest request, HttpServletResponse response, Object handler, Exception ex)</span> <span class="hljs-keyword">throws</span> Exception &#123;<br>        System.out.println(<span class="hljs-string">&quot;拦截器---最终&quot;</span>);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<figure class="highlight xml"><table><tr><td class="code"><pre><code class="hljs xml"><span class="hljs-comment">&lt;!--    配置springMvc拦截器--&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">mvc:interceptors</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">mvc:interceptor</span>&gt;</span><br><span class="hljs-comment">&lt;!--            要拦截的路径--&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">mvc:mapping</span> <span class="hljs-attr">path</span>=<span class="hljs-string">&quot;/Inter/*&quot;</span>/&gt;</span><br><span class="hljs-comment">&lt;!--            &lt;mvc:mapping path=&quot;**&quot;/&gt;表示所有都会拦截--&gt;</span><br><span class="hljs-comment">&lt;!--            配置的拦截类--&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">bean</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;com.mySpringMvc.HandlerInt&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">bean</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">mvc:interceptor</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">mvc:interceptors</span>&gt;</span><br></code></pre></td></tr></table></figure>

<p>序列化原因</p>
<p>web服务器通常将那些暂时不活动但未超时的httpsession对象转移到文件系统或数据库中保存，需要序列化</p>
<p>序列化后对象才能通过流进行数据传输</p>
 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/SSM%E6%A1%86%E6%9E%B6/" rel="tag">SSM框架</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/springMvc/" rel="tag">springMvc</a></li></ul>

    </footer>
  </div>

   
    
</article>

    
    <article
  id="post-spring"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2022/05/04/spring/"
    >spring</a> 
</h2>
 

      
    </header>
     
    <div class="article-meta">
      <a href="/2022/05/04/spring/" class="article-date">
  <time datetime="2022-05-04T14:03:19.294Z" itemprop="datePublished">2022-05-04</time>
</a> 
  <div class="article-category">
    <a class="article-category-link" href="/categories/spring/">spring</a>
  </div>
   
    </div>
      
    <div class="article-entry" itemprop="articleBody">
       
  <p>springIOC</p>
<ul>
<li><img src="C:\Users\19651\AppData\Roaming\Typora\typora-user-images\image-20220103164542950.png" alt="image-20220103164542950"></li>
</ul>
 <figure class="highlight java"><table><tr><td class="code"><pre><code class="hljs java">ApplicationContext application=<span class="hljs-keyword">new</span> <span class="hljs-title class_">ClassPathXmlApplicationContext</span>(<span class="hljs-string">&quot;applicationContext.xml&quot;</span>);<br><span class="hljs-type">SpringS</span> <span class="hljs-variable">prin</span> <span class="hljs-operator">=</span> application.getBean(<span class="hljs-string">&quot;prin&quot;</span>, SpringS.class);<br>prin.prin();<br></code></pre></td></tr></table></figure>

<p>核心容器的两个接口引发出的问题</p>
<p>ApplicationContext</p>
<p>他在构建核心容器时，创建对象采取的策略是采用立即加载的方式。也就是说，只要一读取完配置文件马上就创建配置文件中配置的对象</p>
<figure class="highlight java"><table><tr><td class="code"><pre><code class="hljs java"><span class="hljs-comment">//单例模式适用</span><br>ApplicationContext application=<span class="hljs-keyword">new</span> <span class="hljs-title class_">ClassPathXmlApplicationContext</span>(<span class="hljs-string">&quot;applicationContext.xml&quot;</span>);<span class="hljs-comment">//直接把配置文件里的所有bean全部创建</span><br><span class="hljs-type">SpringS</span> <span class="hljs-variable">prin</span> <span class="hljs-operator">=</span> application.getBean(<span class="hljs-string">&quot;prin&quot;</span>, SpringS.class);<br>prin.prin();<br></code></pre></td></tr></table></figure>

<p>BeanFactory</p>
<p>他在构建核心容器时，创建对象采取的策略是采用延迟加载的方式。也就是说，什么时候根据id获取对象了，什么时候才真正的创建对象</p>
<figure class="highlight java"><table><tr><td class="code"><pre><code class="hljs java"><span class="hljs-comment">//多例模式适用</span><br>Resource resource=<span class="hljs-keyword">new</span> <span class="hljs-title class_">ClassPathResource</span>(<span class="hljs-string">&quot;applicationContext.xml&quot;</span>);<span class="hljs-comment">//仅在使用时创建对象</span><br>BeanFactory beanFactory=<span class="hljs-keyword">new</span> <span class="hljs-title class_">XmlBeanFactory</span>(resource);<br><span class="hljs-type">SpringS</span> <span class="hljs-variable">prin</span> <span class="hljs-operator">=</span> beanFactory.getBean(<span class="hljs-string">&quot;prin&quot;</span>, SpringS.class);<br>prin.prin();<br></code></pre></td></tr></table></figure>

<p>spring创建对象的三种方式</p>
<p> 一、使用默认构造函数创建，在spring的配置文件中使用bean标签，配以id和class属性之后，且没有其他属性和标签时，采用的是默认构造函数创建bean对象，如果类中没有默认构造函数，则对象无法创建</p>
  <figure class="highlight java"><table><tr><td class="code"><pre><code class="hljs java">&lt;!--    采用默认构造函数创建对象--&gt;<br>    &lt;bean id=<span class="hljs-string">&quot;prin&quot;</span> class=<span class="hljs-string">&quot;com.springTest.SpringS&quot;</span>&gt;&lt;/bean&gt;<br></code></pre></td></tr></table></figure>

<p> 二、使用普通工厂中的方法创建对象(使用某个类中的方法创建对象并存入spring容器)</p>
  <figure class="highlight java"><table><tr><td class="code"><pre><code class="hljs java">&lt;!--    采用某个类中的方法创建对象--&gt;<br>    &lt;bean id=<span class="hljs-string">&quot;prinsk&quot;</span> class=<span class="hljs-string">&quot;com.springTest.SpringS&quot;</span>&gt;&lt;/bean&gt;<br>    &lt;bean id=<span class="hljs-string">&quot;sec&quot;</span> factory-bean=<span class="hljs-string">&quot;prinsk&quot;</span> factory-method=<span class="hljs-string">&quot;retu&quot;</span>&gt;&lt;/bean&gt;<br></code></pre></td></tr></table></figure>

<p> 三、使用工厂中的静态方法创建对象(使用某个类中的静态方法创建对象，并存入spring容器)</p>
  <figure class="highlight java"><table><tr><td class="code"><pre><code class="hljs java">&lt;!--    使用某个类中的静态方法创建对象，并存入spring容器--&gt;<br>    &lt;bean id=<span class="hljs-string">&quot;sk&quot;</span> class=<span class="hljs-string">&quot;com.springTest.SpringS&quot;</span> factory-method=<span class="hljs-string">&quot;retu&quot;</span>&gt;&lt;/bean&gt;<br></code></pre></td></tr></table></figure>

<p><img src="C:\Users\19651\AppData\Roaming\Typora\typora-user-images\image-20220103193515488.png" alt="image-20220103193515488"></p>
<p>bean的作用范围调整</p>
<p>bean标签的scope属性</p>
<p>​		作用：用于指定bean的作用范围</p>
<p>​		取值：常用的就是单例和多例的</p>
<p>​				singleton:单例的(默认值)</p>
<p>​				prototype:多例的</p>
<p>​				request:作用于web应用的请求范围</p>
<p>​				session:作用于web应用的会话范围</p>
<p>​				global-session:作用于集群环境的会话范围(全局会话范围)，当不是集群时，它就是session</p>
<p>注入</p>
<p>构造函数注入：</p>
<p>涉及的标签：constructor-arg</p>
<p>标签出现的位置：bean标签的内部</p>
<p>标签中的属性</p>
<p>​	type：用于指定要注入的数据的数据类型，该数据类型也是构造函数中某个或某些参数的类型</p>
<p>​	index：用于指定要注入的数据给构造函数中指定索引位置的参数赋值。索引的位置是从0开始</p>
<p>​	name：用于指定给构造函数中指定名称的参数赋值</p>
<hr>
<p>​	value</p>
<p>​	ref</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">bean</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;prin&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;com.springTest.SpringS&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">constructor-arg</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;username&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;aaa&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">constructor-arg</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">constructor-arg</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;password&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;111&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">constructor-arg</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">bean</span>&gt;</span><br></code></pre></td></tr></table></figure>

<p>set注入:</p>
<p>涉及的标签：property</p>
<p>标签出现的位置：bean标签的内部</p>
<p>标签中的属性</p>
<p>​	name：用于指定注入时所调用的set<strong>方法名称</strong></p>
<p>​	value：用于提供基本类型和String类型的数据</p>
<p>​	ref：用于指定其他的bean类型数据。他指的就是在spring的Ioc核心容器中出现过的bean对象</p>
<p>优势：创建对象时没有明确的限制，可以直接使用默认构造函数</p>
<p>弊端：如果有某个成员必须有值，则获取对象是有可能set方法没有执行</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">bean</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;prin&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;com.springTest.SpringS&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;username&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;aaa&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;password&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;222&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">bean</span>&gt;</span><br></code></pre></td></tr></table></figure>

<p>​			3.复杂类型的注入\集合类型注入</p>
<p>​				用于给List结构注入的标签：</p>
<p>​						list array set</p>
<p>​				用于给Map结构集合注入的标签：</p>
<p>​						map props</p>
<p>​				结构相同，标签可以互换</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">bean</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;coll&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;com.springTest.SpringS&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;list&quot;</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">list</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">value</span>&gt;</span>aaa<span class="hljs-tag">&lt;/<span class="hljs-name">value</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">value</span>&gt;</span>bbb<span class="hljs-tag">&lt;/<span class="hljs-name">value</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">value</span>&gt;</span>ccc<span class="hljs-tag">&lt;/<span class="hljs-name">value</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">list</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;set&quot;</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">set</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">value</span>&gt;</span>kkk<span class="hljs-tag">&lt;/<span class="hljs-name">value</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">value</span>&gt;</span>ppp<span class="hljs-tag">&lt;/<span class="hljs-name">value</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">set</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;strings&quot;</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">array</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">value</span>&gt;</span>qqq<span class="hljs-tag">&lt;/<span class="hljs-name">value</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">value</span>&gt;</span>www<span class="hljs-tag">&lt;/<span class="hljs-name">value</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">array</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span><br><br>    <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;map&quot;</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">map</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">entry</span> <span class="hljs-attr">key</span>=<span class="hljs-string">&quot;sss&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;ooo&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">entry</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">entry</span> <span class="hljs-attr">key</span>=<span class="hljs-string">&quot;rrr&quot;</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">value</span>&gt;</span>hhh<span class="hljs-tag">&lt;/<span class="hljs-name">value</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">entry</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">map</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;properties&quot;</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">props</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">prop</span> <span class="hljs-attr">key</span>=<span class="hljs-string">&quot;lll&quot;</span>&gt;</span>pppppp<span class="hljs-tag">&lt;/<span class="hljs-name">prop</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">props</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">bean</span>&gt;</span><br></code></pre></td></tr></table></figure>

<p>spring注解开发</p>
<ul>
<li><p>用于创建对象的</p>
<p><em>他们的作用就和在XML配置文件中编写一个<bean>标签实现的功能是一样的</em></p>
<p>Component:</p>
<p>​					作用：用于把当前类对象存入spring容器中</p>
<p>​					属性：value：用于指定bean的id当我们不写时，他的默认值是当前类名，且首字母改小写</p>
</li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Component</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">SpringS</span> &#123;&#125;<br></code></pre></td></tr></table></figure>

<figure class="highlight xml"><table><tr><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version=<span class="hljs-string">&quot;1.0&quot;</span> encoding=<span class="hljs-string">&quot;UTF-8&quot;</span>?&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">beans</span> <span class="hljs-attr">xmlns</span>=<span class="hljs-string">&quot;http://www.springframework.org/schema/beans&quot;</span></span><br><span class="hljs-tag">       <span class="hljs-attr">xmlns:xsi</span>=<span class="hljs-string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span><br><span class="hljs-tag">       <span class="hljs-attr">xmlns:context</span>=<span class="hljs-string">&quot;http://www.springframework.org/schema/context&quot;</span></span><br><span class="hljs-tag">       <span class="hljs-attr">xsi:schemaLocation</span>=<span class="hljs-string">&quot;http://www.springframework.org/schema/beans</span></span><br><span class="hljs-string"><span class="hljs-tag">        https://www.springframework.org/schema/beans/spring-beans.xsd </span></span><br><span class="hljs-string"><span class="hljs-tag">        http://www.springframework.org/schema/context </span></span><br><span class="hljs-string"><span class="hljs-tag">        https://www.springframework.org/schema/context/spring-context.xsd&quot;</span>&gt;</span><br><span class="hljs-comment">&lt;!--    spring组件扫描--&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">context:component-scan</span> <span class="hljs-attr">base-package</span>=<span class="hljs-string">&quot;com.springTest&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">context:component-scan</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">beans</span>&gt;</span><br></code></pre></td></tr></table></figure>

<p>  Controller：一般用在表现层</p>
<p>  Service：一般用在业务层</p>
<p>  Repository：一般用在持久层</p>
<p>  以上三个注解他们的作用和属性与Component是一模一样。</p>
<p>  他们三个是spring框架为我们提供明确的三层使用的注解，使我们三层对象更加清晰</p>
<ul>
<li><p>用于注入数据的</p>
<p>他们的作用就和在xml配置文件中的bean标签中写一个<property>标签的作用是一样的</p>
<p>Autowired：</p>
<p>​				作用：自动按照类型注入。只要容器中有<strong>唯一</strong>的一个bean对象类型和要注入的变量类型匹配，就可以注入成功</p>
<p>​							如果Ioc容器中没有任何bean的类型和要注入的变量类型匹配，则报错</p>
<p>​							如果Ioc容器中有多个类型匹配时，则根据变量名匹配Map中的key，一样则注入成功，不一样则报错</p>
<p><img src="C:\Users\19651\AppData\Roaming\Typora\typora-user-images\image-20220104141715692.png" alt="image-20220104141715692"></p>
<p>出现位置：可以是变量上，也可以是方法上</p>
<p>细节：在使用注解注入式，set方法就不是必须的了。</p>
<p>Qualifier：作用：再按照类中注入的基础之上再按照名称注入。他在给类成员注入时不能单独使用，但是在给方法参数注入时可以</p>
<p>​					属性：value：用于指定注入bean的id</p>
<p>Resource：直接按照bean的id注入，它可以独立使用</p>
<p>​					属性：name：用于指定bean的id。</p>
<p>以上三个注入都只能注入其他bean类型的数据，而基本类型和String类型无法使用上述注解实现。另外，集合类型的注入只能通过xml来实现</p>
<p>Value：</p>
<p>​					作用：用于注入基本类型和String类型的数据</p>
<p>​					属性：value用于指定数据的值。它可以使用spring中的SpEL(也就是spring的el表达式) SpEL的写法。${表达式}</p>
<p>用于改变作用范围的：</p>
<p>​					他们的作用就和在bean标签中使用scope属性实现的功能是一样的</p>
<p>​					Scope(作用域是一级一级往上查的，套娃)：作用：用于指定bean的作用范围</p>
<p>​					属性：value：指定范围的取值。常用取值：singleton  prototype		</p>
<p>和生命周期相关 了解</p>
<p>​						他们的作用就和在bean标签中使用init-method和destroy-method的作用是一样的</p>
<p>​						PreDestroy：作用：用于指定销毁方法</p>
<p>​						PostConstruce：作用：用于指定初始化方法</p>
</li>
</ul>
<p>	</p>
<figure class="highlight java"><table><tr><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Component</span><br><span class="hljs-meta">@Scope(&quot;singleton&quot;)</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">SpringS</span> &#123;<br>    <br>    <span class="hljs-comment">//初始化方法 在创建完对象之后调用</span><br>    <span class="hljs-meta">@PostConstruct</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">init</span><span class="hljs-params">()</span>&#123;<br>        System.out.println(<span class="hljs-string">&quot;用户调用初始化方法&quot;</span>);<br>    &#125;<br>    <span class="hljs-comment">//销毁方法 只在单例模式下有用</span><br>    <span class="hljs-meta">@PreDestroy</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">destroy</span><span class="hljs-params">()</span>&#123;<br>        System.out.println(<span class="hljs-string">&quot;用户调用销毁方法&quot;</span>);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>  ​		</p>
<ul>
<li><p>spring新注解</p>
<p>该类是一个配置类，它的作用和bean.xml是一样的</p>
<p>spring中的新注解</p>
<p>Configuration</p>
<p>​					作用：指定当前类是一个配置类</p>
<p>​					细节：当配置类作为AnnotationConfigApplicationContext对象创建的参数时，该注解可不写</p>
</li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><code class="hljs java"><span class="hljs-type">ApplicationContext</span> <span class="hljs-variable">annotationConfigApplicationContext</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">AnnotationConfigApplicationContext</span>(SpringS.class);<br></code></pre></td></tr></table></figure>
<pre><code>        @ComponentScan(&quot;com.springTest&quot;)
</code></pre>
<p>​									作用：用于通过注解指定spring在创建容器时要扫描的包</p>
<p>​									属性：value：它和basePackages的作用是一样的都是用于指定创建容器时要扫描的包，使用此注解就等于在xml中配置了：</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">context:component-scan</span> <span class="hljs-attr">base-package</span>=<span class="hljs-string">&quot;com.springTest&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">context:component-scan</span>&gt;</span><br></code></pre></td></tr></table></figure>

<p>​				Bean</p>
<p>​						作用：用于把当前方法的返回值作为bean对象存入spring的ioc容器中</p>
<p>​						属性：name：用于指定bean的id。当不写时，默认值是当前方法的名称</p>
<p>​						细节：当我们使用注解配置方法时，如果方法有参数，spring框架会去容器中查找有没有可用的bean对象。查找的方式和Autowired注解的作用是一样的</p>
<figure class="highlight java"><table><tr><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Bean(&quot;name&quot;)</span><br><span class="hljs-keyword">public</span> SpringS <span class="hljs-title function_">getSpr</span><span class="hljs-params">()</span>&#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">SpringS</span>();<br>&#125;<br></code></pre></td></tr></table></figure>

<p>​				Import</p>
<p>​							用于导入其他的配置类</p>
<p>​				@PropertySource</p>
<p>​							作用：用于指定properties文件的位置</p>
<p>​							属性：value：指定文件的名称和路径。</p>
<p>​										关键字：classpath：表示类路径下</p>
<p>spring整合junit</p>
<p>应用程序的入口</p>
<p>main方法</p>
<p>junit单元测试中，没有main方法也能执行</p>
<p>junit集成了一个main方法</p>
<p>该方法就会判断当前测试类中哪些方法有@Test注解</p>
<p>junit就让有Test注解的方法执行</p>
<p>junit不会管我们是否采用spring框架</p>
<p>​	在执行测试方法时，junit根本不知到我们是不是使用了spring框架所以也就不会为我们读取配置文件&#x2F;配置类创建spring核心容器</p>
<p>由以上三点可知，当测试方法执行时，没有Ioc容器，就算写了Autowired注解，也无法实现注入</p>
<hr>
<p>使用junit单元测试，测试spring的配置</p>
<p>spring整合junit的配置</p>
<ol>
<li><p>导入spring整合junit的jar(坐标spring-test)</p>
</li>
<li><p>使用junit提供的一个注解把原有的main方法替换了，替换成spring提供的@Runwith</p>
</li>
<li><p>告知spring的运行器，spring和ioc创建是基于xml还是注解的，并且说明位置</p>
<p>@ContextConfiguration</p>
<p>​		locations：指定xml文件的位置，加上classpath关键字，表示在类路径下</p>
<p>​		classes：指定注解类所在的位置</p>
</li>
<li><p>当使用spring5.x版本的时候，要求junit的jar必须是4.12及以上</p>
<figure class="highlight java"><table><tr><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@RunWith(SpringJUnit4ClassRunner.class)</span><br><span class="hljs-meta">@ContextConfiguration(classes = beans.class)</span><span class="hljs-comment">//@ContextConfiguration(locations =&quot;classpath:applicationContext.xml&quot;)</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">AppTest</span><br>&#123;<br>    <span class="hljs-meta">@Autowired</span><br>    <span class="hljs-meta">@Qualifier(&quot;sk&quot;)</span><br>    <span class="hljs-keyword">private</span> SpringS springS=<span class="hljs-literal">null</span>;<br><br>    <span class="hljs-meta">@Test</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">shouldAnswerWithTrue</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> InterruptedException &#123;<br><span class="hljs-comment">//        ClassPathXmlApplicationContext applicationContext = new ClassPathXmlApplicationContext(&quot;applicationContext.xml&quot;);</span><br><span class="hljs-comment">//        SpringS springS = (SpringS) applicationContext.getBean(&quot;springS&quot;);</span><br><span class="hljs-comment">//        ApplicationContext bean = new AnnotationConfigApplicationContext(beans.class);</span><br><span class="hljs-comment">//        SpringS springS = bean.getBean(&quot;sk&quot;, SpringS.class);</span><br>        System.out.println(springS.sk.getUsername());<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure></li>
</ol>
<p>ThreadLocal</p>
<p>ThreadLocal是解决线程安全问题一个很好的思路，它通过为每个线程提供一个独立的变量副本解决了变量并发访问的冲突问题。在很多情况下，ThreadLocal比直接使用synchronized同步机制解决线程安全问题更简单，更方便，且结果程序拥有更高的并发性。</p>
<p>动态代理</p>
<p>JDK动态代理</p>
<figure class="highlight java"><table><tr><td class="code"><pre><code class="hljs Java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">JDKProxy</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">InvocationHandler</span> &#123;<br><br>    <span class="hljs-keyword">private</span> Object object;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setObject</span><span class="hljs-params">(Object object)</span> &#123;<br>        <span class="hljs-built_in">this</span>.object = object;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> Object <span class="hljs-title function_">getProxy</span><span class="hljs-params">(Object object)</span>&#123;<br>        <span class="hljs-built_in">this</span>.object=object;<br>        <span class="hljs-keyword">return</span> Proxy.newProxyInstance(JDKProxy.class.getClassLoader(),object.getClass().getInterfaces(),<span class="hljs-built_in">this</span>);<br>    &#125;<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> Object <span class="hljs-title function_">invoke</span><span class="hljs-params">(Object proxy, Method method, Object[] args)</span> <span class="hljs-keyword">throws</span> Throwable &#123;<br>        System.out.println(<span class="hljs-string">&quot;前置增强&quot;</span>);<br>        Object objects=method.invoke(object,args);<br>        System.out.println(<span class="hljs-string">&quot;后置增强&quot;</span>);<br>        <span class="hljs-keyword">return</span> objects;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>CGLIB动态代理</p>
<figure class="highlight java"><table><tr><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">CGLIBProxy</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">MethodInterceptor</span> &#123;<br><br>    <span class="hljs-keyword">public</span> Object <span class="hljs-title function_">getPro</span><span class="hljs-params">(Object object)</span>&#123;<br>        Enhancer enhancer=<span class="hljs-keyword">new</span> <span class="hljs-title class_">Enhancer</span>();<br>        enhancer.setSuperclass(object.getClass());<br>        enhancer.setCallback(<span class="hljs-built_in">this</span>);<br>        <span class="hljs-keyword">return</span> enhancer.create();<br>    &#125;<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> Object <span class="hljs-title function_">intercept</span><span class="hljs-params">(Object o, Method method, Object[] objects, MethodProxy methodProxy)</span> <span class="hljs-keyword">throws</span> Throwable &#123;<br>        System.out.println(<span class="hljs-string">&quot;前置增强&quot;</span>);<br>        Object o1=methodProxy.invokeSuper(o,objects);<br>        System.out.println(<span class="hljs-string">&quot;后置增强&quot;</span>);<br>        <span class="hljs-keyword">return</span> o1;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>springAop专业术语</p>
<p>连接点(Joinpoint)：被代理类的所有接口方法</p>
<p>切点(Pointcut)：被代理类增强的接口方法</p>
<p>通知(Advice)：切点增强的一些功能  添加日志、管理事务</p>
<p>目标对象(Target)：需要对他进行通知的业务类</p>
<p>织入：将通知添加到目标类具体连接点上的过程</p>
<p>代理：一个类被Aop织入后生成一个结果类，他是融合了原类和通知逻辑的代理类</p>
<p>切面：切面由切点和通知组成</p>
<p>spring切入点写法</p>
<p>标准写法：public void com.springTest.SpringAopTest.test(int,int)</p>
<p>访问修饰符可以省略：void com.springTest.SpringAopTest.test(int,int)</p>
<p>返回值可以使用通配符，表示任意返回值：* com.springTest.SpringAopTest.test(int,int)</p>
<p>包名可以使用通配符，表示任意包，但是有几级包，就需要写几个*： * * . * . * .Account(..)</p>
<p>包名可以使用..表示当前包及子包(中间可以有一个或多个子包)：* * .. Account(..)</p>
<p>全通配写法：* <em>..</em>.*(..)</p>
<p>实际开发中切点的常用写法：* com.Aop.impl.* . *(..)</p>
<p>spring通知</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><code class="hljs xml"><span class="hljs-comment">&lt;!--    springAOP配置--&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">aop:config</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">aop:pointcut</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;pot1&quot;</span> <span class="hljs-attr">expression</span>=<span class="hljs-string">&quot;execution(public * com.springTest.SpringAopTest.*())&quot;</span>/&gt;</span><br><span class="hljs-comment">&lt;!--        配置切面--&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">aop:aspect</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;aspect1&quot;</span> <span class="hljs-attr">ref</span>=<span class="hljs-string">&quot;springAops&quot;</span>&gt;</span><br><span class="hljs-comment">&lt;!--            前置通知--&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">aop:before</span> <span class="hljs-attr">method</span>=<span class="hljs-string">&quot;show&quot;</span> <span class="hljs-attr">pointcut-ref</span>=<span class="hljs-string">&quot;pot1&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">aop:before</span>&gt;</span><br><span class="hljs-comment">&lt;!--            后置通知--&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">aop:after-returning</span> <span class="hljs-attr">method</span>=<span class="hljs-string">&quot;retu&quot;</span> <span class="hljs-attr">pointcut-ref</span>=<span class="hljs-string">&quot;pot1&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">aop:after-returning</span>&gt;</span><br><span class="hljs-comment">&lt;!--            异常通知--&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">aop:after-throwing</span> <span class="hljs-attr">method</span>=<span class="hljs-string">&quot;throwk&quot;</span> <span class="hljs-attr">pointcut-ref</span>=<span class="hljs-string">&quot;pot1&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">aop:after-throwing</span>&gt;</span><br><span class="hljs-comment">&lt;!--            最终通知--&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">aop:after</span> <span class="hljs-attr">method</span>=<span class="hljs-string">&quot;after&quot;</span> <span class="hljs-attr">pointcut-ref</span>=<span class="hljs-string">&quot;pot1&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">aop:after</span>&gt;</span><br><span class="hljs-comment">&lt;!--            环绕通知  增强方法中要有ProceedingJoinpoint--&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">aop:around</span> <span class="hljs-attr">method</span>=<span class="hljs-string">&quot;show&quot;</span> <span class="hljs-attr">pointcut-ref</span>=<span class="hljs-string">&quot;pot1&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">aop:around</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">aop:aspect</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">aop:config</span>&gt;</span><br></code></pre></td></tr></table></figure>

<p>springAop注解实现</p>
<figure class="highlight java"><table><tr><td class="code"><pre><code class="hljs Java"><span class="hljs-keyword">package</span> com.springTest;<br><br><span class="hljs-keyword">import</span> org.aspectj.lang.ProceedingJoinPoint;<br><span class="hljs-keyword">import</span> org.aspectj.lang.annotation.*;<br><span class="hljs-keyword">import</span> org.springframework.stereotype.Component;<br><br><span class="hljs-meta">@Component(&quot;springAops&quot;)</span><br><span class="hljs-meta">@Aspect</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">SpringAops</span> &#123;<br><span class="hljs-comment">//    springAop环绕通知</span><br>    <span class="hljs-meta">@Pointcut(&quot;execution(public * com.springTest.SpringAopTest.*())&quot;)</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">pot1</span><span class="hljs-params">()</span>&#123;&#125;<br>    <span class="hljs-meta">@Around(&quot;pot1()&quot;)</span><br>    <span class="hljs-keyword">public</span> Object <span class="hljs-title function_">show</span><span class="hljs-params">(ProceedingJoinPoint poj)</span>&#123;<br>        Object ob=<span class="hljs-literal">null</span>;<br>        <span class="hljs-keyword">try</span> &#123;<br>            System.out.println(<span class="hljs-string">&quot;前置通知&quot;</span>);<br>            ob=poj.proceed();<br>            System.out.println(<span class="hljs-string">&quot;后置通知&quot;</span>);<br>            <span class="hljs-keyword">return</span> ob;<br>        &#125; <span class="hljs-keyword">catch</span> (Throwable e) &#123;<br>            e.printStackTrace();<br>            System.out.println(<span class="hljs-string">&quot;异常通知&quot;</span>);<br>        &#125;<span class="hljs-keyword">finally</span> &#123;<br>            System.out.println(<span class="hljs-string">&quot;最终通知&quot;</span>);<br>        &#125;<br>        <span class="hljs-keyword">return</span> ob;<br>    &#125;<br>    <span class="hljs-meta">@AfterReturning(&quot;pot1()&quot;)</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">after</span><span class="hljs-params">()</span>&#123;<br>        System.out.println(<span class="hljs-string">&quot;后置通知&quot;</span>);<br>    &#125;<br>    <span class="hljs-meta">@AfterThrowing(&quot;pot1()&quot;)</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">throwk</span><span class="hljs-params">()</span>&#123;<br>        System.out.println(<span class="hljs-string">&quot;异常通知&quot;</span>);<br>    &#125;<br>    <span class="hljs-meta">@After(&quot;pot1()&quot;)</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">retu</span><span class="hljs-params">()</span>&#123;<br>        System.out.println(<span class="hljs-string">&quot;最终通知&quot;</span>);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<figure class="highlight xml"><table><tr><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version=<span class="hljs-string">&quot;1.0&quot;</span> encoding=<span class="hljs-string">&quot;UTF-8&quot;</span>?&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">beans</span> <span class="hljs-attr">xmlns</span>=<span class="hljs-string">&quot;http://www.springframework.org/schema/beans&quot;</span></span><br><span class="hljs-tag">       <span class="hljs-attr">xmlns:xsi</span>=<span class="hljs-string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span><br><span class="hljs-tag">       <span class="hljs-attr">xmlns:context</span>=<span class="hljs-string">&quot;http://www.springframework.org/schema/context&quot;</span></span><br><span class="hljs-tag">       <span class="hljs-attr">xmlns:aop</span>=<span class="hljs-string">&quot;http://www.springframework.org/schema/aop&quot;</span></span><br><span class="hljs-tag">       <span class="hljs-attr">xsi:schemaLocation</span>=<span class="hljs-string">&quot;http://www.springframework.org/schema/beans</span></span><br><span class="hljs-string"><span class="hljs-tag">        https://www.springframework.org/schema/beans/spring-beans.xsd</span></span><br><span class="hljs-string"><span class="hljs-tag">        http://www.springframework.org/schema/context</span></span><br><span class="hljs-string"><span class="hljs-tag">        https://www.springframework.org/schema/context/spring-context.xsd</span></span><br><span class="hljs-string"><span class="hljs-tag">        http://www.springframework.org/schema/aop</span></span><br><span class="hljs-string"><span class="hljs-tag">        https://www.springframework.org/schema/aop/spring-aop.xsd&quot;</span>&gt;</span><br><span class="hljs-comment">&lt;!--    spring组件扫描--&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">context:component-scan</span> <span class="hljs-attr">base-package</span>=<span class="hljs-string">&quot;com.springTest&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">context:component-scan</span>&gt;</span><br><span class="hljs-comment">&lt;!--    开启AOP注解--&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">aop:aspectj-autoproxy</span>/&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">beans</span>&gt;</span><br></code></pre></td></tr></table></figure>

<p>Spring事务管理</p>
<figure class="highlight java"><table><tr><td class="code"><pre><code class="hljs java">&lt;!--    配置事务管理--&gt;<br>    &lt;bean class=<span class="hljs-string">&quot;org.springframework.jdbc.datasource.DataSourceTransactionManager&quot;</span> id=<span class="hljs-string">&quot;dataSourceTransactionManager&quot;</span>&gt;<br>        &lt;!-- 向事务中注入源数据 --&gt;<br>        &lt;property name=<span class="hljs-string">&quot;dataSource&quot;</span> ref=<span class="hljs-string">&quot;dataSource&quot;</span>&gt;&lt;/property&gt;<br>    &lt;/bean&gt;<br>        &lt;!-- 配置事务的通知 --&gt;<br>    &lt;tx:advice id=<span class="hljs-string">&quot;transactionInterceptor&quot;</span> transaction-manager=<span class="hljs-string">&quot;dataSourceTransactionManager&quot;</span>&gt;<br>        <span class="hljs-comment">/**</span><br><span class="hljs-comment">        *isolation:用于指定事务的隔离级别。默认值是DEFAULT，表示使用数据库的默认隔离级别</span><br><span class="hljs-comment">        *propagation:用于指定事务的传播行为。默认值是REQUIRED，表示一定会有事务，增删改的选择。默认方法可以选择SUPPORES</span><br><span class="hljs-comment">        *read-only:用于指定事务是否只读。只有查询方法才能设置为true，默认是false表示读写</span><br><span class="hljs-comment">        *timeout：用于指定事务的超时时间，默认值是-1，表示永不超时。如果指定了数值，以秒为单位。</span><br><span class="hljs-comment">        *rollback-for:用于指定一个异常，当产生该异常时，事务回滚，产生其他异常时事务不回滚，没有默认值，表示任何异常都回滚。</span><br><span class="hljs-comment">        *no-rollback-for：用于指定一个异常，当产生该异常时，事务不回滚，产生其他异常时，事务回滚，没有默认值，表示任何异常都回滚</span><br><span class="hljs-comment">        */</span><br>        &lt;tx:attributes&gt;<br>            &lt;tx:method name=<span class="hljs-string">&quot;*&quot;</span> propagation=<span class="hljs-string">&quot;REQUIRED&quot;</span> read-only=<span class="hljs-string">&quot;false&quot;</span>/&gt;<br>            &lt;tx:method name=<span class="hljs-string">&quot;find*&quot;</span> propagation=<span class="hljs-string">&quot;SUPPORTS&quot;</span> read-only=<span class="hljs-string">&quot;true&quot;</span>/&gt;<br>        &lt;/tx:attributes&gt;<br>    &lt;/tx:advice&gt;<br>    &lt;!--配置事务的切面--&gt;<br>    &lt;aop:config&gt;<br>        &lt;!--设置pointcut 表达式，并且把定义好的事务属性应用到切入点--&gt;<br>        &lt;aop:pointcut id=<span class="hljs-string">&quot;pot1&quot;</span> expression=<span class="hljs-string">&quot;execution(* com.SpringTransaction.service.impl.*.*(..))&quot;</span>/&gt;<br>        &lt;aop:advisor advice-ref=<span class="hljs-string">&quot;transactionInterceptor&quot;</span> pointcut-ref=<span class="hljs-string">&quot;pot1&quot;</span>&gt;&lt;/aop:advisor&gt;<br>    &lt;/aop:config&gt;<br>&lt;!--    proxy-target-class=<span class="hljs-string">&quot;true&quot;</span>设置为<span class="hljs-literal">true</span>则表示为cglib--&gt;<br>&lt;!--    proxy-target-class=<span class="hljs-string">&quot;false&quot;</span>则为jdk动态代理--&gt;<br>    &lt;aop:aspectj-autoproxy  proxy-target-class=<span class="hljs-string">&quot;true&quot;</span>/&gt;<br></code></pre></td></tr></table></figure>

<p>spring事务管理注解方式实现</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version=<span class="hljs-string">&quot;1.0&quot;</span> encoding=<span class="hljs-string">&quot;UTF-8&quot;</span>?&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">beans</span> <span class="hljs-attr">xmlns</span>=<span class="hljs-string">&quot;http://www.springframework.org/schema/beans&quot;</span></span><br><span class="hljs-tag">        <span class="hljs-attr">xmlns:xsi</span>=<span class="hljs-string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span><br><span class="hljs-tag">        <span class="hljs-attr">xmlns:aop</span>=<span class="hljs-string">&quot;http://www.springframework.org/schema/aop&quot;</span>       </span><br><span class="hljs-tag">        <span class="hljs-attr">xmlns:tx</span>=<span class="hljs-string">&quot;http://www.springframework.org/schema/tx&quot;</span> </span><br><span class="hljs-tag">        <span class="hljs-attr">xmlns:context</span>=<span class="hljs-string">&quot;http://www.springframework.org/schema/context&quot;</span></span><br><span class="hljs-tag">        <span class="hljs-attr">xsi:schemaLocation</span>=<span class="hljs-string">&quot;http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd</span></span><br><span class="hljs-string"><span class="hljs-tag">        http://www.springframework.org/schema/tx http://www.springframework.org/schema/tx/spring-tx.xsd</span></span><br><span class="hljs-string"><span class="hljs-tag">        http://www.springframework.org/schema/aop http://www.springframework.org/schema/aop/spring-aop.xsd</span></span><br><span class="hljs-string"><span class="hljs-tag">        http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context.xsd&quot;</span>&gt;</span> <br><span class="hljs-comment">&lt;!-- 配置数据源 --&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">bean</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;dataSource&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;org.springframework.jdbc.datasource.DriverManagerDataSource&quot;</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;driverClassName&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;com.mysql.jdbc.Driver&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;url&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;jdbc:mysql:///spring_demo&quot;</span>/&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;username&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;root&quot;</span>/&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;password&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;root&quot;</span>/&gt;</span>  <br><span class="hljs-tag">&lt;/<span class="hljs-name">bean</span>&gt;</span>  <br><span class="hljs-comment">&lt;!-- 配置JdbcTemplate --&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">bean</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;jdbcTemplate&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;org.springframework.jdbc.core.JdbcTemplate&quot;</span>&gt;</span><br>		<span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;dataSource&quot;</span> <span class="hljs-attr">ref</span>=<span class="hljs-string">&quot;dataSource&quot;</span> /&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">bean</span>&gt;</span><br><span class="hljs-comment">&lt;!-- 配置事务管理器 --&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">bean</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;transactionManager&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;org.springframework.jdbc.datasource.DataSourceTransactionManager&quot;</span>&gt;</span><br>	<span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;dataSource&quot;</span> <span class="hljs-attr">ref</span>=<span class="hljs-string">&quot;dataSource&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">bean</span>&gt;</span><br><span class="hljs-comment">&lt;!-- 开启事务注解 --&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">tx:annotation-driven</span> <span class="hljs-attr">transaction-manager</span>=<span class="hljs-string">&quot;transactionManager&quot;</span>/&gt;</span><br><span class="hljs-comment">&lt;!-- 配置实体类 --&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">bean</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;accountBiz&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;com.tx.AccountBiz&quot;</span>&gt;</span><br>	<span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;accountDao&quot;</span> <span class="hljs-attr">ref</span>=<span class="hljs-string">&quot;accountDao&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">bean</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">bean</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;accountDao&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;com.tx.AccountDao&quot;</span>&gt;</span><br>	<span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;jdbcTemplate&quot;</span> <span class="hljs-attr">ref</span>=<span class="hljs-string">&quot;jdbcTemplate&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">bean</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">beans</span>&gt;</span><br></code></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.tx;<br><span class="hljs-keyword">import</span> org.springframework.jdbc.core.JdbcTemplate;<br><span class="hljs-keyword">import</span> org.springframework.transaction.annotation.Transactional;<br><span class="hljs-comment">//使用@Transactional注解实现事务管理</span><br><span class="hljs-meta">@Transactional</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">AccountDao</span> &#123;<br>	<span class="hljs-keyword">private</span> JdbcTemplate jdbcTemplate;<br>	<span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setJdbcTemplate</span><span class="hljs-params">(JdbcTemplate jdbcTemplate)</span> &#123;<br>		<span class="hljs-built_in">this</span>.jdbcTemplate = jdbcTemplate;<br>	&#125;<br>	<span class="hljs-comment">//银行转账</span><br>	<span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">transfer</span><span class="hljs-params">()</span>&#123;<br>		add();<br>		<span class="hljs-type">int</span> i=<span class="hljs-number">10</span>/<span class="hljs-number">0</span>;<br>		reduce();		<br>	&#125;<br>	<span class="hljs-comment">//增加余额</span><br>	<span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">add</span><span class="hljs-params">()</span>&#123;<br>		String sql=<span class="hljs-string">&quot;update account set balance=balance+? where accountNo=?&quot;</span>;<br>		jdbcTemplate.update(sql, <span class="hljs-number">500</span>,<span class="hljs-number">655925</span>);<br>	&#125;<br>	<span class="hljs-comment">//减少余额</span><br>	<span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">reduce</span><span class="hljs-params">()</span>&#123;<br>		String sql=<span class="hljs-string">&quot;update account set balance=balance-? where accountNo=?&quot;</span>;<br>		jdbcTemplate.update(sql, <span class="hljs-number">500</span>,<span class="hljs-number">358788</span>);<br>	&#125;<br>&#125;<br></code></pre></td></tr></table></figure>
 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/SSM%E6%A1%86%E6%9E%B6/" rel="tag">SSM框架</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Spring/" rel="tag">Spring</a></li></ul>

    </footer>
  </div>

   
    
</article>

    
    <article
  id="post-初学springboot"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2022/05/04/%E5%88%9D%E5%AD%A6springboot/"
    >springBoot</a> 
</h2>
 

      
    </header>
     
    <div class="article-meta">
      <a href="/2022/05/04/%E5%88%9D%E5%AD%A6springboot/" class="article-date">
  <time datetime="2022-05-04T14:02:01.645Z" itemprop="datePublished">2022-05-04</time>
</a> 
  <div class="article-category">
    <a class="article-category-link" href="/categories/springBoot/">springBoot</a>
  </div>
   
    </div>
      
    <div class="article-entry" itemprop="articleBody">
       
  <p>初学springboot(shiro&#x2F;redis&#x2F;dubbo)</p>
<p>配置文件:applicationContext.xml或者application.yaml</p>
<p>其中application.yaml对空格要求非常严格</p>
<figure class="highlight yaml"><table><tr><td class="code"><pre><code class="hljs yaml"><span class="hljs-comment">#对象操作</span><br><span class="hljs-attr">person:</span><br>  <span class="hljs-attr">username:</span> <span class="hljs-string">张三$&#123;random.uuid&#125;</span><br>  <span class="hljs-attr">date:</span> <span class="hljs-number">2022</span><span class="hljs-string">/04/30</span><br>  <span class="hljs-attr">dog:</span><br>    <span class="hljs-attr">name:</span> <span class="hljs-string">$&#123;person.world:旺旺碎冰冰&#125;</span><br>    <span class="hljs-attr">date:</span> <span class="hljs-number">2013</span><span class="hljs-string">/01/12</span><br>  <span class="hljs-attr">list:</span><br>    <span class="hljs-bullet">-</span> <span class="hljs-string">list</span><br>    <span class="hljs-bullet">-</span> <span class="hljs-string">hello</span><br>  <span class="hljs-attr">map:</span> &#123;<span class="hljs-attr">k1:</span> <span class="hljs-string">v1</span>,<span class="hljs-attr">k2:</span> <span class="hljs-string">v2</span>&#125;<br></code></pre></td></tr></table></figure>

<p>@ConfigurationProperties(prefix &#x3D; “person”)</p>
<p>将配置文件中的信息映射到实体类中</p>
<p>@PropertySource(value &#x3D; “classpath:ahui.properties”)指定文件类似于ssm中&lt;context:property-placeholder location&#x3D;”classpath:demo.properties”&#x2F;&gt;</p>
<p>properties文件中文乱码</p>
<p>settings-&gt;file-encodings-&gt;使用utf-8</p>
<p>松散绑定</p>
<p>比如yaml中写的字段名是lst-name这个和lstName是一样的</p>
<p>jsr303校验</p>
<p>加入依赖</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-starter-validation<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>2.3.5.RELEASE<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br></code></pre></td></tr></table></figure>

<p>在类上面加@Validated注解</p>
<p>在要校验的字段上面加注解校验@Email</p>
<p>多环境配置</p>
<figure class="highlight yaml"><table><tr><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">spring:</span><br>  <span class="hljs-attr">profiles:</span><br>    <span class="hljs-attr">active:</span> <span class="hljs-string">dev(此时采用的是application-dev.yaml文件)</span><br></code></pre></td></tr></table></figure>

<p>或</p>
<figure class="highlight yaml"><table><tr><td class="code"><pre><code class="hljs yaml"><span class="hljs-comment">#application.yaml对空格要求非常严格</span><br><span class="hljs-attr">spring:</span><br>  <span class="hljs-attr">profiles:</span><br>    <span class="hljs-attr">active:</span> <span class="hljs-string">dev</span><br><span class="hljs-meta">---</span><br><span class="hljs-attr">spring:</span><br>  <span class="hljs-attr">profiles:</span> <span class="hljs-string">dev</span><br><span class="hljs-attr">server:</span><br>  <span class="hljs-attr">port:</span> <span class="hljs-number">8083</span><br><span class="hljs-meta">---</span><br><span class="hljs-attr">spring:</span><br>  <span class="hljs-attr">profiles:</span> <span class="hljs-string">test</span><br><span class="hljs-attr">server:</span><br>  <span class="hljs-attr">port:</span> <span class="hljs-number">8084</span><br></code></pre></td></tr></table></figure>

<p>配置项目根路径</p>
<figure class="highlight yaml"><table><tr><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">server:</span><br>  <span class="hljs-attr">servlet:</span><br>    <span class="hljs-attr">context-path:</span> <span class="hljs-string">/myPro</span><br></code></pre></td></tr></table></figure>

<p>页面国际化</p>
<p><img src="C:\Users\19651\AppData\Roaming\Typora\typora-user-images\image-20220430212355544.png" alt="image-20220430212355544"></p>
<p><img src="C:\Users\19651\AppData\Roaming\Typora\typora-user-images\image-20220430212430066.png" alt="image-20220430212430066"></p>
<p><img src="C:\Users\19651\AppData\Roaming\Typora\typora-user-images\image-20220430212513491.png" alt="image-20220430212513491"></p>
<p><img src="C:\Users\19651\AppData\Roaming\Typora\typora-user-images\image-20220430212600087.png" alt="image-20220430212600087"></p>
<p>界面：</p>
<figure class="highlight html"><table><tr><td class="code"><pre><code class="hljs html"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">&quot;en&quot;</span> <span class="hljs-attr">xmlns:th</span>=<span class="hljs-string">&quot;http://www.thymeleaf.org&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">&quot;UTF-8&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>Title<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">th:placeholder</span>=<span class="hljs-string">&quot;#&#123;login.username&#125;&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">button</span>&gt;</span>[[#&#123;login.but&#125;]]<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">th:href</span>=<span class="hljs-string">&quot;@&#123;/index.html(l=&#x27;zh_CN&#x27;,zd=&#x27;hello&#x27;)&#125;&quot;</span>&gt;</span>中国<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">th:href</span>=<span class="hljs-string">&quot;@&#123;/index.html(l=en_US)&#125;&quot;</span>&gt;</span>美国<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span><br></code></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.mywrok.config;<br><br><span class="hljs-keyword">import</span> org.hibernate.validator.spi.messageinterpolation.LocaleResolverContext;<br><span class="hljs-keyword">import</span> org.springframework.web.servlet.LocaleResolver;<br><span class="hljs-keyword">import</span> org.thymeleaf.util.StringUtils;<br><br><span class="hljs-keyword">import</span> javax.servlet.http.HttpServletRequest;<br><span class="hljs-keyword">import</span> javax.servlet.http.HttpServletResponse;<br><span class="hljs-keyword">import</span> java.util.Locale;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MyLocalResolver</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">LocaleResolver</span> &#123;<br><br><span class="hljs-comment">//    解析请求</span><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> Locale <span class="hljs-title function_">resolveLocale</span><span class="hljs-params">(HttpServletRequest request)</span> &#123;<br>        <span class="hljs-type">String</span> <span class="hljs-variable">l</span> <span class="hljs-operator">=</span> request.getParameter(<span class="hljs-string">&quot;l&quot;</span>);<br>        <span class="hljs-type">Locale</span> <span class="hljs-variable">aDefault</span> <span class="hljs-operator">=</span> Locale.getDefault();<span class="hljs-comment">//获取默认的地区配置login.properties</span><br>        <span class="hljs-keyword">if</span>(!StringUtils.isEmpty(l))&#123;<br>            String[] s = l.split(<span class="hljs-string">&quot;_&quot;</span>);<br>            aDefault=<span class="hljs-keyword">new</span> <span class="hljs-title class_">Locale</span>(s[<span class="hljs-number">0</span>],s[<span class="hljs-number">1</span>]);<br>        &#125;<br>        <span class="hljs-keyword">return</span> aDefault;<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setLocale</span><span class="hljs-params">(HttpServletRequest request, HttpServletResponse response, Locale locale)</span> &#123;<br><br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.mywrok.config;<br><br><br><span class="hljs-keyword">import</span> org.springframework.context.annotation.Bean;<br><span class="hljs-keyword">import</span> org.springframework.context.annotation.Configuration;<br><span class="hljs-keyword">import</span> org.springframework.web.servlet.LocaleResolver;<br><span class="hljs-keyword">import</span> org.springframework.web.servlet.config.annotation.ViewControllerRegistry;<br><span class="hljs-keyword">import</span> org.springframework.web.servlet.config.annotation.WebMvcConfigurer;<br><br><span class="hljs-meta">@Configuration</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MyMvcConfig</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">WebMvcConfigurer</span> &#123;<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">addViewControllers</span><span class="hljs-params">(ViewControllerRegistry registry)</span> &#123;<br>        registry.addViewController(<span class="hljs-string">&quot;/index.html&quot;</span>).setViewName(<span class="hljs-string">&quot;index&quot;</span>);<br>        registry.addViewController(<span class="hljs-string">&quot;/&quot;</span>).setViewName(<span class="hljs-string">&quot;index&quot;</span>);<br>    &#125;<br><br>    <span class="hljs-meta">@Bean</span><br>    <span class="hljs-keyword">public</span> LocaleResolver <span class="hljs-title function_">localeResolver</span><span class="hljs-params">()</span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">MyLocalResolver</span>();<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>拦截器</p>
<figure class="highlight java"><table><tr><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.mywrok.config;<br><br><span class="hljs-keyword">import</span> org.springframework.web.servlet.HandlerInterceptor;<br><span class="hljs-keyword">import</span> org.springframework.web.servlet.ModelAndView;<br><br><span class="hljs-keyword">import</span> javax.servlet.http.HttpServletRequest;<br><span class="hljs-keyword">import</span> javax.servlet.http.HttpServletResponse;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MyInterceptor</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">HandlerInterceptor</span> &#123;<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">preHandle</span><span class="hljs-params">(HttpServletRequest request, HttpServletResponse response, Object handler)</span> <span class="hljs-keyword">throws</span> Exception &#123;<br>        <span class="hljs-type">Object</span> <span class="hljs-variable">username</span> <span class="hljs-operator">=</span> request.getSession().getAttribute(<span class="hljs-string">&quot;username&quot;</span>);<br>        <span class="hljs-keyword">if</span>(username==<span class="hljs-literal">null</span>)&#123;<br>            request.getRequestDispatcher(<span class="hljs-string">&quot;/login.html&quot;</span>).forward(request,response);<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>        &#125;<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.mywrok.config;<br><br><br><span class="hljs-keyword">import</span> org.springframework.context.annotation.Bean;<br><span class="hljs-keyword">import</span> org.springframework.context.annotation.Configuration;<br><span class="hljs-keyword">import</span> org.springframework.web.servlet.LocaleResolver;<br><span class="hljs-keyword">import</span> org.springframework.web.servlet.config.annotation.InterceptorRegistry;<br><span class="hljs-keyword">import</span> org.springframework.web.servlet.config.annotation.ViewControllerRegistry;<br><span class="hljs-keyword">import</span> org.springframework.web.servlet.config.annotation.WebMvcConfigurer;<br><br><span class="hljs-meta">@Configuration</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MyMvcConfig</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">WebMvcConfigurer</span> &#123;<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">addInterceptors</span><span class="hljs-params">(InterceptorRegistry registry)</span> &#123;<br>        registry.addInterceptor(<span class="hljs-keyword">new</span> <span class="hljs-title class_">MyInterceptor</span>()).addPathPatterns(<span class="hljs-string">&quot;/**&quot;</span>).excludePathPatterns(<span class="hljs-string">&quot;/login.html&quot;</span>,<span class="hljs-string">&quot;/&quot;</span>,<span class="hljs-string">&quot;/css/**&quot;</span>,<span class="hljs-string">&quot;/js/**&quot;</span>,<span class="hljs-string">&quot;/images/**&quot;</span>);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>thymeleaf组件化使用</p>
<p>th:fragment&#x3D;”slideFragment”</p>
<p>使用组件:1<div th:insert="~{页面名::slideFragment}"></div></p>
<p>2<div th:replace="~{commons/commons::slideFragment}"></div></p>
<p>组件化传参</p>
<figure class="highlight html"><table><tr><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">th:insert</span>=<span class="hljs-string">&quot;~&#123;commons/commons::hell(color=&#x27;green&#x27;)&#125;&quot;</span>&gt;</span><br><br><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">th:replace</span>=<span class="hljs-string">&quot;~&#123;commons/commons::hell(color=&#x27;red&#x27;)&#125;&quot;</span>&gt;</span><br><br><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br></code></pre></td></tr></table></figure>

<figure class="highlight html"><table><tr><td class="code"><pre><code class="hljs html"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">&quot;en&quot;</span>&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">h1</span> <span class="hljs-attr">th:fragment</span>=<span class="hljs-string">&quot;hell&quot;</span> <span class="hljs-attr">th:style</span>=<span class="hljs-string">&quot;$&#123;color==&#x27;red&#x27;&#125;?&#x27;color:red&#x27;:&#x27;color:green&#x27;&quot;</span>&gt;</span>HELLO WORLD<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span><br><br><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span><br></code></pre></td></tr></table></figure>

<p>日期格式问题</p>
<figure class="highlight yaml"><table><tr><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">spring:</span><br>	<span class="hljs-attr">mvc:</span><br>  		<span class="hljs-attr">date-format:</span> <span class="hljs-string">yyyy-MM-dd</span><br></code></pre></td></tr></table></figure>

<p>前端传过来的日期格式必须是yyyy-MM-dd格式,默认是(yyyy&#x2F;MM&#x2F;dd形式)</p>
<p>springboot整合mybatis</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>          <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>mysql<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>          <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>mysql-connector-java<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>          <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>5.1.2<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br>          <span class="hljs-tag">&lt;<span class="hljs-name">scope</span>&gt;</span>runtime<span class="hljs-tag">&lt;/<span class="hljs-name">scope</span>&gt;</span><br>      <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br>      <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>          <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.mybatis.spring.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>          <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>mybatis-spring-boot-starter<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>          <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>1.3.2<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br>      <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br>      <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>          <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>com.alibaba<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>          <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>druid<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>          <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>1.1.9<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br>      <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br></code></pre></td></tr></table></figure>

<figure class="highlight xml"><table><tr><td class="code"><pre><code class="hljs xml">spring:<br>#页面国际化<br>  messages:<br>    basename: i18n.login<br>  datasource:<br>    username: root<br>    password: 123456<br>    driver-class-name: com.mysql.jdbc.Driver<br>    url: jdbc:mysql://localhost:3306/springboottest<br>    type: com.alibaba.druid.pool.DruidDataSource<br><br>#mybatis<br>mybatis:<br>  mapper-locations: classpath:mybatis/mapper/*.xml<br>  type-aliases-package: com.mywrok.pojo<br></code></pre></td></tr></table></figure>

<p>在启动类Application加注解@MapperScan(“com.mywrok.dao”)</p>
<p>安全&#x3D;》认证&amp;授权</p>
<p>SpringSecurity，shiro针对spring项目于的安全框架</p>
<p>authorize：授权</p>
<p>authentication：认证</p>
<p>WebSecurityConfigurerAdapter：自定义security策略</p>
<p>AuthenticationManagerBuilder：自定义认证策略</p>
<p>@EnableWebSecurity：开启WebSecurity策略</p>
<p>SpringSecurity的两个主要目标是”认证(authentication)”和”授权(authorize)”(访问控制)</p>
<figure class="highlight java"><table><tr><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.mywrok.config;<br><br><br><span class="hljs-keyword">import</span> org.springframework.security.authentication.AuthenticationTrustResolver;<br><span class="hljs-keyword">import</span> org.springframework.security.config.annotation.authentication.builders.AuthenticationManagerBuilder;<br><span class="hljs-keyword">import</span> org.springframework.security.config.annotation.web.builders.HttpSecurity;<br><span class="hljs-keyword">import</span> org.springframework.security.config.annotation.web.configuration.EnableWebSecurity;<br><span class="hljs-keyword">import</span> org.springframework.security.config.annotation.web.configuration.WebSecurityConfiguration;<br><span class="hljs-keyword">import</span> org.springframework.security.config.annotation.web.configuration.WebSecurityConfigurerAdapter;<br><span class="hljs-keyword">import</span> org.springframework.security.crypto.bcrypt.BCryptPasswordEncoder;<br><span class="hljs-keyword">import</span> org.springframework.security.crypto.password.PasswordEncoder;<br><br><span class="hljs-meta">@EnableWebSecurity</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">SecurityConfig</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">WebSecurityConfigurerAdapter</span> &#123;<br><span class="hljs-comment">//    链式编程</span><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">configure</span><span class="hljs-params">(HttpSecurity http)</span> <span class="hljs-keyword">throws</span> Exception &#123;<br>        http.authorizeRequests()<br>                .antMatchers(<span class="hljs-string">&quot;/&quot;</span>).permitAll()<br>                .antMatchers(<span class="hljs-string">&quot;/leve1/**&quot;</span>).hasRole(<span class="hljs-string">&quot;vip1&quot;</span>)<br>                .antMatchers(<span class="hljs-string">&quot;/leve2/**&quot;</span>).hasRole(<span class="hljs-string">&quot;vip2&quot;</span>)<br>                .antMatchers(<span class="hljs-string">&quot;/leve3/**&quot;</span>).hasRole(<span class="hljs-string">&quot;vip3&quot;</span>);<br><span class="hljs-comment">//        跳到登录界面</span><br><span class="hljs-comment">//        没有权限默认会跳到登录界面，需要开启登录的界面</span><br>        http.formLogin();<br><br><span class="hljs-comment">//        注销</span><br>        在thymeleaf中&lt;a th:href=<span class="hljs-string">&quot;@&#123;/logout&#125;&quot;</span>&gt;&lt;/a&gt;<br>        http.logout().logoutSuccessUrl(<span class="hljs-string">&quot;/&quot;</span>);<span class="hljs-comment">//注销成功界面</span><br>    &#125;<br><br><span class="hljs-comment">//    认证</span><br><span class="hljs-comment">//PasswordEncoder是数据加密</span><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">configure</span><span class="hljs-params">(AuthenticationManagerBuilder auth)</span> <span class="hljs-keyword">throws</span> Exception &#123;<br><span class="hljs-comment">//        这些数据正常应该从数据库中读</span><br>        auth.inMemoryAuthentication().passwordEncoder(<span class="hljs-keyword">new</span> <span class="hljs-title class_">BCryptPasswordEncoder</span>())<br>                .withUser(<span class="hljs-string">&quot;root&quot;</span>).password(<span class="hljs-keyword">new</span> <span class="hljs-title class_">BCryptPasswordEncoder</span>().encode(<span class="hljs-string">&quot;123456&quot;</span>)).roles(<span class="hljs-string">&quot;vip1&quot;</span>,<span class="hljs-string">&quot;vip2&quot;</span>,<span class="hljs-string">&quot;vip3&quot;</span>).and()<br>                .withUser(<span class="hljs-string">&quot;genter&quot;</span>).password(<span class="hljs-keyword">new</span> <span class="hljs-title class_">BCryptPasswordEncoder</span>().encode(<span class="hljs-string">&quot;123456&quot;</span>)).roles(<span class="hljs-string">&quot;vip1&quot;</span>).and()<br>                .withUser(<span class="hljs-string">&quot;rule&quot;</span>).password(<span class="hljs-keyword">new</span> <span class="hljs-title class_">BCryptPasswordEncoder</span>().encode(<span class="hljs-string">&quot;123456&quot;</span>)).roles(<span class="hljs-string">&quot;vip2&quot;</span>,<span class="hljs-string">&quot;vip3&quot;</span>);<br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure>

<p>访问数据库：</p>
<p><img src="C:\Users\19651\AppData\Roaming\Typora\typora-user-images\image-20220501231420354.png"></p>
<p>springSecurity整合thymeleaf所用依赖</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><code class="hljs xml"><span class="hljs-comment">&lt;!-- https://mvnrepository.com/artifact/org.thymeleaf.extras/thymeleaf-extras-springsecurity5 --&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.thymeleaf.extras<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>thymeleaf-extras-springsecurity5<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>3.0.4.RELEASE<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br></code></pre></td></tr></table></figure>

<p>thymeleaf头部加xmlns:sec&#x3D;”<a target="_blank" rel="noopener" href="http://www.thymeleaf.org/thymeleaf-extras-springsecurity5&quot;">http://www.thymeleaf.org/thymeleaf-extras-springsecurity5&quot;</a></p>
<figure class="highlight html"><table><tr><td class="code"><pre><code class="hljs html"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">&quot;en&quot;</span> <span class="hljs-attr">xmlns:th</span>=<span class="hljs-string">&quot;http://www.thymeleaf.org&quot;</span></span><br><span class="hljs-tag">      <span class="hljs-attr">xmlns:sec</span>=<span class="hljs-string">&quot;http://www.thymeleaf.org/thymeleaf-extras-springsecurity5&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">&quot;UTF-8&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>Title<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">h1</span> <span class="hljs-attr">style</span>=<span class="hljs-string">&quot;color: green&quot;</span>&gt;</span>leve1.html<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">th:href</span>=<span class="hljs-string">&quot;@&#123;/logout&#125;&quot;</span>&gt;</span>退出<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span>使用springSecurity自带的logout界面<br><span class="hljs-comment">&lt;!--如果未认证--&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">sec:authorize</span>=<span class="hljs-string">&quot;!isAuthenticated()&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">h1</span> <span class="hljs-attr">style</span>=<span class="hljs-string">&quot;color: coral&quot;</span>&gt;</span>未认证消息<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br><span class="hljs-comment">&lt;!--如果认证--&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">sec:authorize</span>=<span class="hljs-string">&quot;isAuthenticated()&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">h1</span> <span class="hljs-attr">style</span>=<span class="hljs-string">&quot;color: coral&quot;</span>&gt;</span>认证消息<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">sec:authentication</span>=<span class="hljs-string">&quot;name&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span><br></code></pre></td></tr></table></figure>

<p>记住我及首页定制</p>
<figure class="highlight java"><table><tr><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.mywrok.config;<br><br><br><span class="hljs-keyword">import</span> org.springframework.security.authentication.AuthenticationTrustResolver;<br><span class="hljs-keyword">import</span> org.springframework.security.config.annotation.authentication.builders.AuthenticationManagerBuilder;<br><span class="hljs-keyword">import</span> org.springframework.security.config.annotation.web.builders.HttpSecurity;<br><span class="hljs-keyword">import</span> org.springframework.security.config.annotation.web.configuration.EnableWebSecurity;<br><span class="hljs-keyword">import</span> org.springframework.security.config.annotation.web.configuration.WebSecurityConfiguration;<br><span class="hljs-keyword">import</span> org.springframework.security.config.annotation.web.configuration.WebSecurityConfigurerAdapter;<br><span class="hljs-keyword">import</span> org.springframework.security.crypto.bcrypt.BCryptPasswordEncoder;<br><span class="hljs-keyword">import</span> org.springframework.security.crypto.password.PasswordEncoder;<br><br><span class="hljs-meta">@EnableWebSecurity</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">SecurityConfig</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">WebSecurityConfigurerAdapter</span> &#123;<br><span class="hljs-comment">//    链式编程</span><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">configure</span><span class="hljs-params">(HttpSecurity http)</span> <span class="hljs-keyword">throws</span> Exception &#123;<br>        http.authorizeRequests()<br>                .antMatchers(<span class="hljs-string">&quot;/&quot;</span>).permitAll()<br>                .antMatchers(<span class="hljs-string">&quot;/leve1/**&quot;</span>).hasRole(<span class="hljs-string">&quot;vip1&quot;</span>)<br>                .antMatchers(<span class="hljs-string">&quot;/leve2/**&quot;</span>).hasRole(<span class="hljs-string">&quot;vip2&quot;</span>)<br>                .antMatchers(<span class="hljs-string">&quot;/leve3/**&quot;</span>).hasRole(<span class="hljs-string">&quot;vip3&quot;</span>);<br><span class="hljs-comment">//        跳到登录界面</span><br><span class="hljs-comment">//        没有权限默认会跳到登录界面，需要开启登录的界面</span><br>        http.formLogin().usernameParameter(<span class="hljs-string">&quot;username&quot;</span>).passwordParameter(<span class="hljs-string">&quot;password&quot;</span>).loginPage(<span class="hljs-string">&quot;/userLogin&quot;</span>);<br>        或者<br>            <span class="hljs-comment">//http.formLogin().usernameParameter(&quot;username&quot;).passwordParameter(&quot;password&quot;).loginPage(&quot;/userLogin&quot;).loginProcessingUrl(&quot;/login&quot;);调用默认的login此时userLogin.HTML中action中写的是@&#123;/login&#125;</span><br><br><span class="hljs-comment">//        注销</span><br>        http.csrf().disable();<span class="hljs-comment">//关闭跨站域请求伪造,不关闭csrf可能注销不了</span><br>        http.logout().logoutSuccessUrl(<span class="hljs-string">&quot;/&quot;</span>);<span class="hljs-comment">//注销成功界面</span><br><br><span class="hljs-comment">//        记住我</span><br>        http.rememberMe().rememberMeParameter(<span class="hljs-string">&quot;remember&quot;</span>);<br>    &#125;<br><br><span class="hljs-comment">//    认证</span><br><span class="hljs-comment">//PasswordEncoder是数据加密</span><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">configure</span><span class="hljs-params">(AuthenticationManagerBuilder auth)</span> <span class="hljs-keyword">throws</span> Exception &#123;<br><span class="hljs-comment">//        这些数据正常应该从数据库中读</span><br>        auth.inMemoryAuthentication().passwordEncoder(<span class="hljs-keyword">new</span> <span class="hljs-title class_">BCryptPasswordEncoder</span>())<br>                .withUser(<span class="hljs-string">&quot;root&quot;</span>).password(<span class="hljs-keyword">new</span> <span class="hljs-title class_">BCryptPasswordEncoder</span>().encode(<span class="hljs-string">&quot;123456&quot;</span>)).roles(<span class="hljs-string">&quot;vip1&quot;</span>,<span class="hljs-string">&quot;vip2&quot;</span>,<span class="hljs-string">&quot;vip3&quot;</span>).and()<br>                .withUser(<span class="hljs-string">&quot;genter&quot;</span>).password(<span class="hljs-keyword">new</span> <span class="hljs-title class_">BCryptPasswordEncoder</span>().encode(<span class="hljs-string">&quot;123456&quot;</span>)).roles(<span class="hljs-string">&quot;vip1&quot;</span>).and()<br>                .withUser(<span class="hljs-string">&quot;rule&quot;</span>).password(<span class="hljs-keyword">new</span> <span class="hljs-title class_">BCryptPasswordEncoder</span>().encode(<span class="hljs-string">&quot;123456&quot;</span>)).roles(<span class="hljs-string">&quot;vip2&quot;</span>,<span class="hljs-string">&quot;vip3&quot;</span>);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<figure class="highlight html"><table><tr><td class="code"><pre><code class="hljs html"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">&quot;en&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">&quot;UTF-8&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>Title<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">form</span> <span class="hljs-attr">th:action</span>=<span class="hljs-string">&quot;@&#123;/userLogin&#125;&quot;</span> <span class="hljs-attr">method</span>=<span class="hljs-string">&quot;post&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>用户名<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;text&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;username&quot;</span>/&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>密码<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;password&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;password&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;checkbox&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;remember&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;submit&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;提交&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">form</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span><br></code></pre></td></tr></table></figure>

<p>Shiro</p>
<p>Apache Shiro是一个Java的安全(权限)框架</p>
<p>Shiro可以完成，认证，授权，加密，会话管理</p>
<p>快速入门：</p>
<p><img src="https://img-blog.csdnimg.cn/20201202215335331.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2JieHlscWYxMjZjb20=,size_16,color_FFFFFF,t_70#" alt="在这里插入图片描述"></p>
<h5 id="Subject"><a href="#Subject" class="headerlink" title="Subject"></a>Subject</h5><p><code>Subject</code>即主体，外部应用与subject进行交互，subject记录了当前的操作用户，将用户的概念理解为当前操作的主体。外部程序通过subject进行认证授权，而subject是通过SecurityManager安全管理器进行认证授权</p>
<h5 id="SecurityManager"><a href="#SecurityManager" class="headerlink" title="SecurityManager"></a><strong>SecurityManager</strong></h5><p>SecurityManager即安全管理器，对全部的subject进行安全管理，它是shiro的核心，负责对所有的subject进行安全管理。通过SecurityManager可以完成subject的认证、授权等，实质上SecurityManager是通过Authenticator进行认证，通过Authorizer进行授权，通过SessionManager进行会话管理等</p>
<p>SecurityManager是一个接口，继承了Authenticator, Authorizer, SessionManager这三个接口</p>
<h5 id="Authenticator"><a href="#Authenticator" class="headerlink" title="Authenticator"></a>Authenticator</h5><p>Authenticator即认证器，对用户身份进行认证，Authenticator是一个接口，shiro提供ModularRealmAuthenticator实现类，通过ModularRealmAuthenticator基本上可以满足大多数需求，也可以自定义认证器</p>
<h5 id="Authorizer"><a href="#Authorizer" class="headerlink" title="Authorizer"></a>Authorizer</h5><p><code>Authorizer</code>即授权器，用户通过认证器认证通过，在访问功能时需要通过授权器判断用户是否有此功能的操作权限</p>
<h5 id="Realm"><a href="#Realm" class="headerlink" title="Realm"></a>Realm</h5><p>Realm即领域，相当于datasource数据源，securityManager进行安全认证需要通过Realm获取用户权限数据，比如：如果用户身份数据在数据库那么realm就需要从数据库获取用户身份信息</p>
<p>不要把realm理解成只是从数据源取数据，在realm中还有认证授权校验的相关的代码</p>
<h5 id="SessionManager"><a href="#SessionManager" class="headerlink" title="SessionManager"></a>SessionManager</h5><p><code>sessionManager</code>即会话管理，shiro框架定义了一套会话管理，它不依赖web容器的<a target="_blank" rel="noopener" href="https://so.csdn.net/so/search?q=session&spm=1001.2101.3001.7020">session</a>，所以shiro可以使用在非web应用上，也可以将分布式应用的会话集中在一点管理，此特性可使它实现单点登录</p>
<h5 id="SessionDAO"><a href="#SessionDAO" class="headerlink" title="SessionDAO"></a>SessionDAO</h5><p>SessionDAO即会话dao，是对session会话操作的一套接口，比如要将session存储到数据库，可以通过jdbc将会话存储到数据库</p>
<h5 id="CacheManager"><a href="#CacheManager" class="headerlink" title="CacheManager"></a>CacheManager</h5><p>CacheManager即缓存管理，将用户权限数据存储在缓存，这样可以提高性能</p>
<h5 id="Cryptography"><a href="#Cryptography" class="headerlink" title="Cryptography"></a>Cryptography</h5><p>Cryptography即密码管理，shiro提供了一套加密&#x2F;解密的组件，方便开发。比如提供常用的散列、加&#x2F;解密等功能。</p>
<h4 id="shiro认证"><a href="#shiro认证" class="headerlink" title="shiro认证"></a>shiro认证</h4><h5 id="什么是认证"><a href="#什么是认证" class="headerlink" title="什么是认证"></a>什么是认证</h5><p>身份认证，就是判断一个用户是否为合法用户的处理过程。最常用的简单身份认证方式是系统通过核对用户输入的用户名和口令，看其是否与系统中存储的该用户的用户名和口令一致，来判断用户身份是否正确</p>
<h5 id="Subject-1"><a href="#Subject-1" class="headerlink" title="Subject"></a>Subject</h5><p>访问系统的用户，主体可以是用户、程序等，进行认证的都称为主体</p>
<h5 id="Principal"><a href="#Principal" class="headerlink" title="Principal"></a>Principal</h5><p>身份信息，是主体（subject）进行身份认证的标识，标识必须具有唯一性，如用户名、手机号、邮箱地址等，一个主体可以有多个身份，但是必须有一个主身份（Primary Principal）</p>
<h5 id="credential"><a href="#credential" class="headerlink" title="credential"></a>credential</h5><p>凭证信息，是只有主体自己知道的安全信息，如密码、证书等</p>
<figure class="highlight java"><table><tr><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> org.apache.shiro.authc.AuthenticationException;<br><span class="hljs-keyword">import</span> org.apache.shiro.authc.AuthenticationInfo;<br><span class="hljs-keyword">import</span> org.apache.shiro.authc.AuthenticationToken;<br><span class="hljs-keyword">import</span> org.apache.shiro.authz.AuthorizationInfo;<br><span class="hljs-keyword">import</span> org.apache.shiro.realm.AuthorizingRealm;<br><span class="hljs-keyword">import</span> org.apache.shiro.subject.PrincipalCollection;<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * 自定义realm</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">CustomerRealm</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">AuthorizingRealm</span> &#123;<br>    <span class="hljs-comment">// 授权</span><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">protected</span> AuthorizationInfo <span class="hljs-title function_">doGetAuthorizationInfo</span><span class="hljs-params">(PrincipalCollection principals)</span> &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;<br>    &#125;<br><br>    <span class="hljs-comment">// 认证</span><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">protected</span> AuthenticationInfo <span class="hljs-title function_">doGetAuthenticationInfo</span><span class="hljs-params">(AuthenticationToken token)</span> <span class="hljs-keyword">throws</span> AuthenticationException &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;<br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> com.christy.shiro.realm.CustomerRealm;<br><span class="hljs-keyword">import</span> org.apache.shiro.realm.Realm;<br><span class="hljs-keyword">import</span> org.apache.shiro.spring.web.ShiroFilterFactoryBean;<br><span class="hljs-keyword">import</span> org.apache.shiro.web.mgt.DefaultWebSecurityManager;<br><span class="hljs-keyword">import</span> org.springframework.context.annotation.Bean;<br><span class="hljs-keyword">import</span> org.springframework.context.annotation.Configuration;<br><br><span class="hljs-keyword">import</span> java.util.HashMap;<br><span class="hljs-keyword">import</span> java.util.Map;<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * Shiro的核心配置类，用来整合shiro框架</span><br><span class="hljs-comment"> */</span><br><span class="hljs-meta">@Configuration</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ShiroConfiguration</span> &#123;<br><br>    <span class="hljs-comment">//1.创建shiroFilter  //负责拦截所有请求</span><br>    <span class="hljs-meta">@Bean</span><br>    <span class="hljs-keyword">public</span> ShiroFilterFactoryBean <span class="hljs-title function_">getShiroFilterFactoryBean</span><span class="hljs-params">(DefaultWebSecurityManager defaultWebSecurityManager)</span>&#123;<br>        <span class="hljs-type">ShiroFilterFactoryBean</span> <span class="hljs-variable">shiroFilterFactoryBean</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ShiroFilterFactoryBean</span>();<br><br>        <span class="hljs-comment">//给filter设置安全管理器</span><br>        shiroFilterFactoryBean.setSecurityManager(defaultWebSecurityManager);<br><br>        <span class="hljs-comment">//配置系统受限资源</span><br>        <span class="hljs-comment">//配置系统公共资源</span><br>        Map&lt;String,String&gt; map = <span class="hljs-keyword">new</span> <span class="hljs-title class_">HashMap</span>&lt;String,String&gt;();<br>        map.put(<span class="hljs-string">&quot;/index.jsp&quot;</span>,<span class="hljs-string">&quot;authc&quot;</span>);<span class="hljs-comment">//authc 请求这个资源需要认证和授权</span><br><br>        <span class="hljs-comment">//默认认证界面路径</span><br>        shiroFilterFactoryBean.setLoginUrl(<span class="hljs-string">&quot;/login.jsp&quot;</span>);<br>        shiroFilterFactoryBean.setFilterChainDefinitionMap(map);<br><br>        <span class="hljs-keyword">return</span> shiroFilterFactoryBean;<br>    &#125;<br><br>    <span class="hljs-comment">//2.创建安全管理器</span><br>    <span class="hljs-meta">@Bean</span><br>    <span class="hljs-keyword">public</span> DefaultWebSecurityManager <span class="hljs-title function_">getDefaultWebSecurityManager</span><span class="hljs-params">(Realm realm)</span>&#123;<br>        <span class="hljs-type">DefaultWebSecurityManager</span> <span class="hljs-variable">defaultWebSecurityManager</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">DefaultWebSecurityManager</span>();<br>        <span class="hljs-comment">//给安全管理器设置</span><br>        defaultWebSecurityManager.setRealm(realm);<br><br>        <span class="hljs-keyword">return</span> defaultWebSecurityManager;<br>    &#125;<br><br>    <span class="hljs-comment">//3.创建自定义realm</span><br>    <span class="hljs-meta">@Bean</span><br>    <span class="hljs-keyword">public</span> Realm <span class="hljs-title function_">getRealm</span><span class="hljs-params">()</span>&#123;<br>        <span class="hljs-type">CustomerRealm</span> <span class="hljs-variable">customerRealm</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">CustomerRealm</span>();<br>        <span class="hljs-keyword">return</span> customerRealm;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>



<h5 id="swagger"><a href="#swagger" class="headerlink" title="swagger"></a>swagger</h5><p>最流行的Api框架</p>
<p>Restful Api文档在线自动生成工具&#x3D;》Api文档与API定义同步更新</p>
<p>直接运行，可以在线测试API接口</p>
<p>支持多种语言：(java，php…)</p>
<figure class="highlight java"><table><tr><td class="code"><pre><code class="hljs java">Failed to start bean &amp;#<span class="hljs-number">39</span>;documentationPluginsBootstrapper&amp;#<span class="hljs-number">39</span>;; nested exception is java.lang.NullPointerException----springboot版本太高c<br></code></pre></td></tr></table></figure>

<p>springboot使用2.5.6版本整合swagger3.0</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">parent</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-starter-parent<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br><span class="hljs-comment">&lt;!--        &lt;version&gt;2.6.7&lt;/version&gt;--&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>2.5.6<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">relativePath</span>/&gt;</span> <span class="hljs-comment">&lt;!-- lookup parent from repository --&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">parent</span>&gt;</span><br></code></pre></td></tr></table></figure>

<p>swagge依赖</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>io.springfox<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>springfox-boot-starter<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>3.0.0<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br></code></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.mywrok.config;<br><br><span class="hljs-keyword">import</span> org.springframework.context.annotation.Configuration;<br><span class="hljs-keyword">import</span> org.springframework.web.bind.annotation.RequestMapping;<br><span class="hljs-keyword">import</span> org.springframework.web.bind.annotation.ResponseBody;<br><span class="hljs-keyword">import</span> springfox.documentation.oas.annotations.EnableOpenApi;<br><span class="hljs-keyword">import</span> springfox.documentation.swagger2.annotations.EnableSwagger2;<br><br><span class="hljs-meta">@Configuration</span><br><span class="hljs-meta">@EnableSwagger2</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">SwaggerTest</span> &#123;<br><br>  <span class="hljs-meta">@Bean</span><br>   <span class="hljs-keyword">public</span> Docket <span class="hljs-title function_">docket</span><span class="hljs-params">(Environment environment)</span>&#123;<br>       <span class="hljs-type">Profiles</span> <span class="hljs-variable">dev</span> <span class="hljs-operator">=</span> Profiles.of(<span class="hljs-string">&quot;dev&quot;</span>);<br><span class="hljs-comment">//       监听环境是否是测试环境,如果是返回true 可以返回接口</span><br>       <span class="hljs-type">boolean</span> <span class="hljs-variable">boo</span> <span class="hljs-operator">=</span> environment.acceptsProfiles(dev);<br>       <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Docket</span>(DocumentationType.SWAGGER_2).groupName(<span class="hljs-string">&quot;d阿辉&quot;</span>)<br>                .apiInfo(apiInfo()).enable(boo).select()<br><span class="hljs-comment">//       RequestHandlerSelectors配置要扫描接口的方式</span><br><span class="hljs-comment">//       basePackage指定要扫描接口的包</span><br><span class="hljs-comment">//                any()全部</span><br><span class="hljs-comment">//                none不扫描</span><br><span class="hljs-comment">//       withClassAnnotation扫描类上的注解-&gt;参数是类的反射</span><br><span class="hljs-comment">//       withMethodAnnotation扫描方法上的注解</span><br>                .apis(RequestHandlerSelectors.basePackage(<span class="hljs-string">&quot;com.mywrok.controller&quot;</span>))<br>                .build();<br>   &#125;<br>   <span class="hljs-keyword">public</span> ApiInfo <span class="hljs-title function_">apiInfo</span><span class="hljs-params">()</span>&#123;<br>       <span class="hljs-type">Contact</span> <span class="hljs-variable">contact</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Contact</span>(<span class="hljs-string">&quot;阿辉&quot;</span>, <span class="hljs-string">&quot;&quot;</span>, <span class="hljs-string">&quot;1965165252@qq.com&quot;</span>);<br>       <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ApiInfo</span>(<span class="hljs-string">&quot;阿辉的swagger&quot;</span>,<br>               <span class="hljs-string">&quot;即使再小的帆也能远航&quot;</span>,<br>               <span class="hljs-string">&quot;1.0v&quot;</span>,<br>               <span class="hljs-string">&quot;http://baidu.com&quot;</span>,<br>               contact, <span class="hljs-string">&quot;Apache 2.0&quot;</span>,<br>               <span class="hljs-string">&quot;http://www.apache.org/licenses/LICENSE-2.0&quot;</span>,<br>               <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>());<br>   &#125;<br><br>   <span class="hljs-meta">@Bean</span><br>   <span class="hljs-keyword">public</span> Docket <span class="hljs-title function_">docket1</span><span class="hljs-params">()</span>&#123;<br>       <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Docket</span>(DocumentationType.SWAGGER_2).groupName(<span class="hljs-string">&quot;小红&quot;</span>).select().apis(RequestHandlerSelectors.none()).build();<br>   &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>访问接口</p>
<figure class="highlight http"><table><tr><td class="code"><pre><code class="hljs http">http://localhost:8080/&#123;base-path&#125;/swagger-ui/#/<br></code></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="code"><pre><code class="hljs java"><span class="hljs-comment">//给生成的swagger的model加注释</span><br><span class="hljs-meta">@Data</span><br><span class="hljs-meta">@ApiModel</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Admin</span> &#123;<br>    <span class="hljs-meta">@ApiModelProperty(&quot;id&quot;)</span><br>    <span class="hljs-keyword">private</span> Integer id;<br>    <span class="hljs-meta">@ApiModelProperty(&quot;用户名&quot;)</span><br>    <span class="hljs-keyword">private</span> String username;<br>    <span class="hljs-meta">@ApiModelProperty(&quot;密码&quot;)</span><br>    <span class="hljs-keyword">private</span> String password;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>异步任务（之前都是等待方法完成在执行下一步，现在可以跳过等待时间直接执行下一步）</p>
<p>在主运行类上开启异步@EnableAsync</p>
<p>在service上加异步注解@Async&#x3D;》表示这个一个异步操作可以先执行下面的</p>
<p>邮件任务</p>
<p>加入依赖</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><code class="hljs xml"><span class="hljs-comment">&lt;!--        邮件任务--&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-starter-mail<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br></code></pre></td></tr></table></figure>

<figure class="highlight yaml"><table><tr><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">spring:</span><br> <span class="hljs-attr">mail:</span><br>  <span class="hljs-attr">username:</span> <span class="hljs-number">1965165252</span><span class="hljs-string">@qq.com</span><br>  <span class="hljs-attr">password:</span> <span class="hljs-string">通过qq邮件获取设置-》</span><br>  <span class="hljs-attr">host:</span> <span class="hljs-string">smtp.qq.com</span><br>  <span class="hljs-attr">properties:</span><br>    <span class="hljs-attr">mail:</span><br>      <span class="hljs-attr">smtp:</span><br>        <span class="hljs-attr">ssl:</span><br>          <span class="hljs-attr">enable:</span> <span class="hljs-literal">true</span><br></code></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.mywrok;<br><br><span class="hljs-keyword">import</span> org.junit.jupiter.api.Test;<br><span class="hljs-keyword">import</span> org.springframework.beans.factory.annotation.Autowired;<br><span class="hljs-keyword">import</span> org.springframework.boot.test.context.SpringBootTest;<br><span class="hljs-keyword">import</span> org.springframework.mail.SimpleMailMessage;<br><span class="hljs-keyword">import</span> org.springframework.mail.javamail.JavaMailSenderImpl;<br><br><span class="hljs-keyword">import</span> javax.sql.DataSource;<br><span class="hljs-keyword">import</span> java.sql.Connection;<br><br><br><span class="hljs-meta">@SpringBootTest</span><br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">SpringbootLearnApplicationTests</span> &#123;<br>    <span class="hljs-meta">@Autowired</span><br>    <span class="hljs-keyword">private</span> JavaMailSenderImpl javaMailSender;<br><br>    <span class="hljs-meta">@Test</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">sendMail</span><span class="hljs-params">()</span>&#123;<br>        <span class="hljs-comment">//简单邮件发送</span><br>        SimpleMailMessage simpleMailMessage=<span class="hljs-keyword">new</span> <span class="hljs-title class_">SimpleMailMessage</span>();<br>        simpleMailMessage.setSubject(<span class="hljs-string">&quot;hello 阿辉&quot;</span>);<span class="hljs-comment">//主题</span><br>        simpleMailMessage.setText(<span class="hljs-string">&quot;许久未见&quot;</span>);<span class="hljs-comment">//内容</span><br>        simpleMailMessage.setFrom(<span class="hljs-string">&quot;1965165252@qq.com&quot;</span>);<span class="hljs-comment">//自己的qq邮箱</span><br>        simpleMailMessage.setTo(<span class="hljs-string">&quot;1965165252@qq.com&quot;</span>);<span class="hljs-comment">//发送地址</span><br>        javaMailSender.send(simpleMailMessage);<br>    &#125;<br>    <span class="hljs-meta">@Test</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">sendMain2</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> MessagingException &#123;<br>        <span class="hljs-comment">//复杂邮件发送</span><br>        <span class="hljs-type">MimeMessage</span> <span class="hljs-variable">mimeMessage</span> <span class="hljs-operator">=</span> javaMailSender.createMimeMessage();<br>        <span class="hljs-type">MimeMessageHelper</span> <span class="hljs-variable">mimeMessageHelper</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">MimeMessageHelper</span>(mimeMessage,<span class="hljs-literal">true</span>);<br><br>        mimeMessageHelper.setSubject(<span class="hljs-string">&quot;hello 阿辉&quot;</span>);<br>        mimeMessageHelper.setText(<span class="hljs-string">&quot;&lt;p style=&#x27;color:red&#x27;&gt;hello world&lt;/p&gt;&quot;</span>,<span class="hljs-literal">true</span>);<br><br>        mimeMessageHelper.addAttachment(<span class="hljs-string">&quot;1.jpg&quot;</span>,<span class="hljs-keyword">new</span> <span class="hljs-title class_">File</span>(<span class="hljs-string">&quot;A:\\壁纸\\img\\cover12.4.jpg&quot;</span>));<br><br>        mimeMessageHelper.setFrom(<span class="hljs-string">&quot;1965165252@qq.com&quot;</span>);<br>        mimeMessageHelper.setTo(<span class="hljs-string">&quot;1965165252@qq.com&quot;</span>);<br>        javaMailSender.send(mimeMessage);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>定时任务</p>
<p>cron表达式</p>
<p>cron表达式，六个值 （秒，分，时，日，月，星期)</p>
<ul>
<li><p>*： 表示匹配该域的任意值。比如Minutes域使用*，就表示每分钟都会触发。</p>
</li>
<li><p>-：表示范围。比如Minutes域使用 10-20，就表示从10分钟到20分钟每分钟都会触发一次。</p>
</li>
<li><p>,：表示列出枚举值。比如Minutes域使用1,3，就表示1分钟和3分钟都会触发一次。</p>
</li>
<li><p>&#x2F; : 表示间隔时间触发(开始时间&#x2F;时间间隔)。例如在Minutes域使用 5&#x2F;10，就表示从第5分钟开始，每隔10分钟触发一次。</p>
</li>
<li><p>? : 表示不指定值。简单理解就是忽略该字段的值，直接根据另一个字段的值触发执行。</p>
</li>
<li><p>表示该月第n个星期x(x#n)，仅用星期域。如：星期：6#3，表示该月的第三个星期五。</p>
</li>
<li><p>L : 表示最后，是单词”last”的缩写（最后一天或最后一个星期几）；仅出现在日和星期的域中。用在日则表示该月的最后一天，用在星期则表示该月的最后一个星期。如：星期域上的值为5L，则表示该月最后一个星期的星期四。在使用’L’时，不要指定列表’,’或范围’-‘，否则易导致出现意料之外的结果。</p>
</li>
<li><p>W: 仅用在日的域中，表示距离当月给定日期最近的工作日（周一到周五），是单词”weekday”的缩写。</p>
</li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@EnableScheduling</span><span class="hljs-comment">//在运行类开启定时功能注解</span><br><span class="hljs-meta">@Scheduled</span><span class="hljs-comment">//什么时候执行,在service类中使用</span><br>TaskScheduler<span class="hljs-comment">//任务调度者</span><br>TaskExecutor<span class="hljs-comment">//任务执行者</span><br></code></pre></td></tr></table></figure>

<p>远程服务调用(RPC)</p>
<p>rpc两个核心模块:通讯，序列化(数据传输需要转换)</p>
<p>什么时dubbo？</p>
<p>dubbo是一款高性能，轻量级的开源java rpc框架，它提供了三大核心能力，面向接口的远程方法调用，智能容错和负载均衡，以及服务自动注册和发现</p>
<p>zookeeper相当于Registry</p>
<p><strong>dubbo暴露端口之后向Registry注册，消费者向Registry请求，有的话返回接口地址，消费者通过地址向提供者请求端口</strong></p>
<p><img src="C:\Users\19651\AppData\Roaming\Typora\typora-user-images\image-20220503140425666.png" alt="image-20220503140425666"></p>
<p>安装zookeeper</p>
<p><a target="_blank" rel="noopener" href="https://www.apache.org/dyn/closer.lua/zookeeper/zookeeper-3.8.0/apache-zookeeper-3.8.0-bin.tar.gz">Apache Downloads</a></p>
<p>下载后解压，将config目录下的zoo_sample.cfg 重命名为 zoo.cfg (Zookeeper配置文件，默认端口为2181，可根据实际进行修改)。然后双击bin目录下的zkServer.cmd启动即可。</p>
<p>管理员身份运行zkServer.sh报错(可在内部加pause，暂停查看报错信息),也有可能是8080端口冲突</p>
<p>dubbo下载地址：<a target="_blank" rel="noopener" href="https://github.com/dangdangdotcom/dubbox">https://github.com/dangdangdotcom/dubbox</a></p>
<figure class="highlight cmd"><table><tr><td class="code"><pre><code class="hljs cmd"><span class="hljs-function">G:\<span class="hljs-title">dubbo</span>\<span class="hljs-title">dubbox</span>-<span class="hljs-title">master</span>&gt;<span class="hljs-title">mvn</span> <span class="hljs-title">clean</span> <span class="hljs-title">package</span> -<span class="hljs-title">Dmaven.test.skip</span>=<span class="hljs-title">true</span></span><br></code></pre></td></tr></table></figure>
 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/springBoot/" rel="tag">springBoot</a></li></ul>

    </footer>
  </div>

   
    
</article>

    
    <article
  id="post-ssm整合"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2022/05/04/ssm%E6%95%B4%E5%90%88/"
    >SSM整合</a> 
</h2>
 

      
    </header>
     
    <div class="article-meta">
      <a href="/2022/05/04/ssm%E6%95%B4%E5%90%88/" class="article-date">
  <time datetime="2022-05-04T14:00:58.904Z" itemprop="datePublished">2022-05-04</time>
</a> 
  <div class="article-category">
    <a class="article-category-link" href="/categories/spring-springMvc-mybatis/">spring+springMvc+mybatis</a>
  </div>
   
    </div>
      
    <div class="article-entry" itemprop="articleBody">
       
  <p>ssm整合</p>
<p><em>目录结构</em></p>
<p><img src="C:\Users\19651\AppData\Roaming\Typora\typora-user-images\image-20220115101619458.png" alt="image-20220115101619458"></p>
<p>实现pojo实体类</p>
<figure class="highlight java"><table><tr><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.mySSM.pojo;<br><br><span class="hljs-keyword">import</span> java.io.Serializable;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Admin</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Serializable</span> &#123;<br>    <span class="hljs-keyword">private</span> Integer id;<br>    <span class="hljs-keyword">private</span> String username;<br>    <span class="hljs-keyword">private</span> String password;<br>    <span class="hljs-keyword">private</span> Double money;<br>    <span class="hljs-keyword">public</span> Integer <span class="hljs-title function_">getId</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> id;<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setId</span><span class="hljs-params">(Integer id)</span> &#123;<br>        <span class="hljs-built_in">this</span>.id = id;<br>    &#125;<br>    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">getUsername</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> username;<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setUsername</span><span class="hljs-params">(String username)</span> &#123;<br>        <span class="hljs-built_in">this</span>.username = username;<br>    &#125;<br>    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">getPassword</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> password;<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setPassword</span><span class="hljs-params">(String password)</span> &#123;<br>        <span class="hljs-built_in">this</span>.password = password;<br>    &#125;<br>    <span class="hljs-keyword">public</span> Double <span class="hljs-title function_">getMoney</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> money;<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setMoney</span><span class="hljs-params">(Double money)</span> &#123;<br>        <span class="hljs-built_in">this</span>.money = money;<br>    &#125;<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">toString</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;Admin&#123;&quot;</span> +<br>                <span class="hljs-string">&quot;id=&quot;</span> + id +<br>                <span class="hljs-string">&quot;, username=&#x27;&quot;</span> + username + <span class="hljs-string">&#x27;\&#x27;&#x27;</span> +<br>                <span class="hljs-string">&quot;, password=&#x27;&quot;</span> + password + <span class="hljs-string">&#x27;\&#x27;&#x27;</span> +<br>                <span class="hljs-string">&quot;, money=&quot;</span> + money +<br>                <span class="hljs-string">&#x27;&#125;&#x27;</span>;<br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure>

<p>dao层</p>
<p>dao接口</p>
<figure class="highlight java"><table><tr><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.mySSM.dao;<br><br><span class="hljs-keyword">import</span> com.mySSM.pojo.Admin;<br><span class="hljs-keyword">import</span> org.apache.ibatis.annotations.Param;<br><span class="hljs-keyword">import</span> org.springframework.stereotype.Repository;<br><span class="hljs-keyword">import</span> org.springframework.transaction.annotation.Transactional;<br><br><span class="hljs-keyword">import</span> java.util.List;<br><span class="hljs-meta">@Repository</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">AdminDao</span> &#123;<br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * 查询所有信息</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@return</span></span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-keyword">public</span> List&lt;Admin&gt; <span class="hljs-title function_">findAll</span><span class="hljs-params">()</span>;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * 减钱数</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> username</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> money</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@return</span></span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">desMoney</span><span class="hljs-params">(<span class="hljs-meta">@Param(&quot;username&quot;)</span> String username, <span class="hljs-meta">@Param(&quot;money&quot;)</span> Double money)</span>;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * 增加钱数</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> username</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> money</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@return</span></span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">addMoney</span><span class="hljs-params">(<span class="hljs-meta">@Param(&quot;username&quot;)</span> String username,<span class="hljs-meta">@Param(&quot;money&quot;)</span> Double money)</span>;<br>&#125;<br><br></code></pre></td></tr></table></figure>

<p>dao的xml</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version=<span class="hljs-string">&quot;1.0&quot;</span> encoding=<span class="hljs-string">&quot;UTF-8&quot;</span> ?&gt;</span><br><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">mapper</span> <span class="hljs-keyword">PUBLIC</span> <span class="hljs-string">&quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span> <span class="hljs-string">&quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">mapper</span> <span class="hljs-attr">namespace</span>=<span class="hljs-string">&quot;com.mySSM.dao.AdminDao&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">select</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;findAll&quot;</span> <span class="hljs-attr">resultType</span>=<span class="hljs-string">&quot;admin&quot;</span>&gt;</span><br>        select * from ssmtest.admin<br>    <span class="hljs-tag">&lt;/<span class="hljs-name">select</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">update</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;desMoney&quot;</span> &gt;</span><br>        update ssmtest.admin set money=money-#&#123;money&#125; where username=#&#123;username&#125;<br>    <span class="hljs-tag">&lt;/<span class="hljs-name">update</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">update</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;addMoney&quot;</span> &gt;</span><br>        update ssmtest.admin set money=money+#&#123;money&#125; where username=#&#123;username&#125;<br>    <span class="hljs-tag">&lt;/<span class="hljs-name">update</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">mapper</span>&gt;</span><br></code></pre></td></tr></table></figure>

<p>servlet层</p>
<figure class="highlight java"><table><tr><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.mySSM.service;<br><br><span class="hljs-keyword">import</span> com.mySSM.pojo.Admin;<br><br><span class="hljs-keyword">import</span> java.util.List;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">AdminService</span> &#123;<br>    <span class="hljs-keyword">public</span> List&lt;Admin&gt; <span class="hljs-title function_">findAll</span><span class="hljs-params">()</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">updMoney</span><span class="hljs-params">(String username,Double money,String username2,Double money2)</span>;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>实现接口</p>
<figure class="highlight java"><table><tr><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.mySSM.service.impl;<br><br><span class="hljs-keyword">import</span> com.mySSM.dao.AdminDao;<br><span class="hljs-keyword">import</span> com.mySSM.pojo.Admin;<br><span class="hljs-keyword">import</span> com.mySSM.service.AdminService;<br><span class="hljs-keyword">import</span> org.springframework.beans.factory.annotation.Autowired;<br><span class="hljs-keyword">import</span> org.springframework.stereotype.Service;<br><span class="hljs-keyword">import</span> org.springframework.transaction.annotation.Transactional;<br><br><span class="hljs-keyword">import</span> javax.servlet.http.HttpServletRequest;<br><span class="hljs-keyword">import</span> java.util.List;<br><br><span class="hljs-meta">@Service</span><br><span class="hljs-meta">@Transactional</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">AdminServiceImpl</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">AdminService</span> &#123;<br>    <span class="hljs-meta">@Autowired</span><br>    <span class="hljs-keyword">private</span> AdminDao adminDao;<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> List&lt;Admin&gt; <span class="hljs-title function_">findAll</span><span class="hljs-params">()</span> &#123;<br>        System.out.println(<span class="hljs-string">&quot;执行了查询所有信息语句......&quot;</span>);<br>        List&lt;Admin&gt; all = adminDao.findAll();<br>        <span class="hljs-keyword">return</span> all;<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">updMoney</span><span class="hljs-params">(String username, Double money, String username2, Double money2)</span> &#123;<br>        <span class="hljs-type">int</span> i=adminDao.addMoney(username,money);<br>        <span class="hljs-type">int</span> p=<span class="hljs-number">1</span>/<span class="hljs-number">0</span>;<br>        <span class="hljs-type">int</span> j=adminDao.desMoney(username2,money2);<br>        <span class="hljs-keyword">if</span>(i&gt;<span class="hljs-number">0</span>&amp;&amp;j&gt;<span class="hljs-number">0</span>)&#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;<br>        &#125;<br>        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>    &#125;<br><br><br>&#125;<br></code></pre></td></tr></table></figure>

<p>controller层</p>
<figure class="highlight java"><table><tr><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.mySSM.controller;<br><br><span class="hljs-keyword">import</span> com.mySSM.pojo.Admin;<br><span class="hljs-keyword">import</span> com.mySSM.service.AdminService;<br><span class="hljs-keyword">import</span> org.springframework.beans.factory.annotation.Autowired;<br><span class="hljs-keyword">import</span> org.springframework.beans.factory.annotation.Qualifier;<br><span class="hljs-keyword">import</span> org.springframework.stereotype.Controller;<br><span class="hljs-keyword">import</span> org.springframework.test.annotation.Rollback;<br><span class="hljs-keyword">import</span> org.springframework.transaction.annotation.Transactional;<br><span class="hljs-keyword">import</span> org.springframework.web.bind.annotation.RequestMapping;<br><br><span class="hljs-keyword">import</span> javax.servlet.http.HttpServletRequest;<br><span class="hljs-keyword">import</span> java.util.List;<br><br><span class="hljs-meta">@Controller</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Controllers</span> &#123;<br>    <span class="hljs-meta">@Autowired</span><br>    <span class="hljs-meta">@Qualifier(&quot;adminServiceImpl&quot;)</span><br>    <span class="hljs-keyword">private</span> AdminService adminService;<br><br>    <span class="hljs-keyword">public</span> AdminService <span class="hljs-title function_">getAdminService</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> adminService;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setAdminService</span><span class="hljs-params">(AdminService adminService)</span> &#123;<br>        <span class="hljs-built_in">this</span>.adminService = adminService;<br>    &#125;<br><br>    <span class="hljs-meta">@RequestMapping(&quot;/findAll&quot;)</span><br>    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">findAll</span><span class="hljs-params">(HttpServletRequest request,String username)</span>&#123;<br>        List&lt;Admin&gt; all = adminService.findAll();<br>        request.setAttribute(<span class="hljs-string">&quot;userInfos&quot;</span>,all);<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;success&quot;</span>;<br>    &#125;<br>    <span class="hljs-meta">@RequestMapping(&quot;/changeMoney&quot;)</span><br>    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">changeMoney</span><span class="hljs-params">(String username,Double money,String username2,Double money2)</span>&#123;<br>        <span class="hljs-type">int</span> i=adminService.updMoney(username,money,username2,money2);<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;success&quot;</span>;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>spring.xml配置</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version=<span class="hljs-string">&quot;1.0&quot;</span> encoding=<span class="hljs-string">&quot;UTF-8&quot;</span>?&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">beans</span> <span class="hljs-attr">xmlns</span>=<span class="hljs-string">&quot;http://www.springframework.org/schema/beans&quot;</span></span><br><span class="hljs-tag">       <span class="hljs-attr">xmlns:xsi</span>=<span class="hljs-string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span><br><span class="hljs-tag">       <span class="hljs-attr">xmlns:context</span>=<span class="hljs-string">&quot;http://www.springframework.org/schema/context&quot;</span> <span class="hljs-attr">xmlns:tx</span>=<span class="hljs-string">&quot;http://www.springframework.org/schema/tx&quot;</span></span><br><span class="hljs-tag">       <span class="hljs-attr">xmlns:aop</span>=<span class="hljs-string">&quot;http://www.springframework.org/schema/aop&quot;</span></span><br><span class="hljs-tag">       <span class="hljs-attr">xsi:schemaLocation</span>=<span class="hljs-string">&quot;http://www.springframework.org/schema/beans</span></span><br><span class="hljs-string"><span class="hljs-tag">       http://www.springframework.org/schema/beans/spring-beans.xsd http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context.xsd http://www.springframework.org/schema/tx http://www.springframework.org/schema/tx/spring-tx.xsd http://www.springframework.org/schema/aop http://www.springframework.org/schema/aop/spring-aop.xsd&quot;</span>&gt;</span><br><br>    <span class="hljs-tag">&lt;<span class="hljs-name">context:component-scan</span> <span class="hljs-attr">base-package</span>=<span class="hljs-string">&quot;com.mySSM&quot;</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">context:exclude-filter</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;annotation&quot;</span> <span class="hljs-attr">expression</span>=<span class="hljs-string">&quot;org.springframework.web.bind.annotation.ControllerAdvice&quot;</span>/&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">context:exclude-filter</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;annotation&quot;</span> <span class="hljs-attr">expression</span>=<span class="hljs-string">&quot;org.springframework.stereotype.Controller&quot;</span>/&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">context:component-scan</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">bean</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;dataSource&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;org.springframework.jdbc.datasource.DriverManagerDataSource&quot;</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;driverClassName&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;com.mysql.jdbc.Driver&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;url&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;jdbc:mysql://localhost:3306/ssmtest&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;username&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;root&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;password&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;123456&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">bean</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">bean</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;sqlSessionFactoryBean&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;org.mybatis.spring.SqlSessionFactoryBean&quot;</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;dataSource&quot;</span> <span class="hljs-attr">ref</span>=<span class="hljs-string">&quot;dataSource&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;typeAliasesPackage&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;com.mySSM.pojo&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">bean</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">bean</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;org.mybatis.spring.mapper.MapperScannerConfigurer&quot;</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;mapperScannerConfigurer&quot;</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;basePackage&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;com.mySSM.dao&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">bean</span>&gt;</span><br><span class="hljs-comment">&lt;!--    配置事务管理--&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">bean</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;dataSourceTransactionManager&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;org.springframework.jdbc.datasource.DataSourceTransactionManager&quot;</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;dataSource&quot;</span> <span class="hljs-attr">ref</span>=<span class="hljs-string">&quot;dataSource&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">bean</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">tx:advice</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;txManager&quot;</span> <span class="hljs-attr">transaction-manager</span>=<span class="hljs-string">&quot;dataSourceTransactionManager&quot;</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">tx:attributes</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">tx:method</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;find*&quot;</span> <span class="hljs-attr">read-only</span>=<span class="hljs-string">&quot;true&quot;</span> <span class="hljs-attr">propagation</span>=<span class="hljs-string">&quot;SUPPORTS&quot;</span>/&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">tx:method</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;*&quot;</span> <span class="hljs-attr">read-only</span>=<span class="hljs-string">&quot;false&quot;</span> <span class="hljs-attr">propagation</span>=<span class="hljs-string">&quot;REQUIRED&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">tx:method</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">tx:attributes</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">tx:advice</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">aop:config</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">aop:pointcut</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;pot1&quot;</span> <span class="hljs-attr">expression</span>=<span class="hljs-string">&quot;execution(* com.mySSM.service.*..*(..))&quot;</span>/&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">aop:advisor</span> <span class="hljs-attr">advice-ref</span>=<span class="hljs-string">&quot;txManager&quot;</span> <span class="hljs-attr">pointcut-ref</span>=<span class="hljs-string">&quot;pot1&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">aop:advisor</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">aop:config</span>&gt;</span><br><span class="hljs-comment">&lt;!--    &lt;tx:annotation-driven transaction-manager=&quot;dataSourceTransactionManager&quot;/&gt;--&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">beans</span>&gt;</span><br></code></pre></td></tr></table></figure>

<p>springmvc层配置</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version = <span class="hljs-string">&quot;1.0&quot;</span> encoding = <span class="hljs-string">&quot;utf-8&quot;</span>?&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">beans</span> <span class="hljs-attr">xmlns:xsi</span>=<span class="hljs-string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span><br><span class="hljs-tag">       <span class="hljs-attr">xmlns</span>=<span class="hljs-string">&quot;http://www.springframework.org/schema/beans&quot;</span> <span class="hljs-attr">xmlns:context</span>=<span class="hljs-string">&quot;http://www.springframework.org/schema/context&quot;</span></span><br><span class="hljs-tag">       <span class="hljs-attr">xmlns:tx</span>=<span class="hljs-string">&quot;http://www.springframework.org/schema/tx&quot;</span> <span class="hljs-attr">xmlns:aop</span>=<span class="hljs-string">&quot;http://www.springframework.org/schema/aop&quot;</span></span><br><span class="hljs-tag">       <span class="hljs-attr">xmlns:mvc</span>=<span class="hljs-string">&quot;http://www.springframework.org/schema/mvc&quot;</span></span><br><span class="hljs-tag">       <span class="hljs-attr">xsi:schemaLocation</span>=<span class="hljs-string">&quot;http://www.springframework.org/schema/beans</span></span><br><span class="hljs-string"><span class="hljs-tag">       http://www.springframework.org/schema/beans/spring-beans.xsd</span></span><br><span class="hljs-string"><span class="hljs-tag">       http://www.springframework.org/schema/context</span></span><br><span class="hljs-string"><span class="hljs-tag">       http://www.springframework.org/schema/context/spring-context.xsd</span></span><br><span class="hljs-string"><span class="hljs-tag">       http://www.springframework.org/schema/tx</span></span><br><span class="hljs-string"><span class="hljs-tag">       http://www.springframework.org/schema/tx/spring-tx.xsd</span></span><br><span class="hljs-string"><span class="hljs-tag">       http://www.springframework.org/schema/aop</span></span><br><span class="hljs-string"><span class="hljs-tag">       http://www.springframework.org/schema/aop/spring-aop.xsd</span></span><br><span class="hljs-string"><span class="hljs-tag">       http://www.springframework.org/schema/mvc</span></span><br><span class="hljs-string"><span class="hljs-tag">       http://www.springframework.org/schema/mvc/spring-mvc.xsd &quot;</span>&gt;</span><br><br>    <span class="hljs-tag">&lt;<span class="hljs-name">context:component-scan</span> <span class="hljs-attr">base-package</span>=<span class="hljs-string">&quot;com.mySSM.controller&quot;</span> <span class="hljs-attr">use-default-filters</span>=<span class="hljs-string">&quot;false&quot;</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">context:include-filter</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;annotation&quot;</span> <span class="hljs-attr">expression</span>=<span class="hljs-string">&quot;org.springframework.stereotype.Controller&quot;</span>/&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">context:exclude-filter</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;annotation&quot;</span> <span class="hljs-attr">expression</span>=<span class="hljs-string">&quot;org.springframework.stereotype.Service&quot;</span>/&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">context:component-scan</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">bean</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;org.springframework.web.servlet.view.InternalResourceViewResolver&quot;</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;internalResourceViewResolver&quot;</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;prefix&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;/WEB-INF/pages/&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;suffix&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;.jsp&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">bean</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">mvc:annotation-driven</span> /&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">beans</span>&gt;</span><br></code></pre></td></tr></table></figure>

<p>jsp界面</p>
<figure class="highlight jsp"><table><tr><td class="code"><pre><code class="hljs jsp">&lt;%--<br>  Created by IntelliJ IDEA.<br>  User: <span class="hljs-number">19651</span><br>  Date: <span class="hljs-number">2022</span>/<span class="hljs-number">1</span>/<span class="hljs-number">13</span><br>  Time: <span class="hljs-number">19</span>:<span class="hljs-number">46</span><br>  To change <span class="hljs-built_in">this</span> template use File | Settings | File Templates.<br>--%&gt;<br>&lt;%@ page contentType=<span class="hljs-string">&quot;text/html;charset=UTF-8&quot;</span> language=<span class="hljs-string">&quot;java&quot;</span> %&gt;<br>&lt;html&gt;<br>&lt;head&gt;<br>    &lt;title&gt;Title&lt;/title&gt;<br>&lt;/head&gt;<br>&lt;body&gt;<br>&lt;a href=<span class="hljs-string">&quot;findAll?username=aaa&quot;</span>&gt;查询&lt;/a&gt;<br>&lt;a href=<span class="hljs-string">&quot;changeMoney?username=aaa&amp;money=10&amp;username2=bbb&amp;money2=10&quot;</span>&gt;修改钱数&lt;/a&gt;<br>&lt;/body&gt;<br>&lt;/html&gt;<br></code></pre></td></tr></table></figure>

<p>web.xml配置</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">web-app</span> <span class="hljs-keyword">PUBLIC</span></span><br><span class="hljs-meta"> <span class="hljs-string">&quot;-//Sun Microsystems, Inc.//DTD Web Application 2.3//EN&quot;</span></span><br><span class="hljs-meta"> <span class="hljs-string">&quot;http://java.sun.com/dtd/web-app_2_3.dtd&quot;</span> &gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">web-app</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">display-name</span>&gt;</span>Archetype Created Web Application<span class="hljs-tag">&lt;/<span class="hljs-name">display-name</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">context-param</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">param-name</span>&gt;</span>contextConfigLocation<span class="hljs-tag">&lt;/<span class="hljs-name">param-name</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">param-value</span>&gt;</span>classpath:applicationContext.xml<span class="hljs-tag">&lt;/<span class="hljs-name">param-value</span>&gt;</span><br>  <span class="hljs-tag">&lt;/<span class="hljs-name">context-param</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">listener</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">listener-class</span>&gt;</span>org.springframework.web.context.ContextLoaderListener<span class="hljs-tag">&lt;/<span class="hljs-name">listener-class</span>&gt;</span><br>  <span class="hljs-tag">&lt;/<span class="hljs-name">listener</span>&gt;</span><br><br>  <span class="hljs-tag">&lt;<span class="hljs-name">filter</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">filter-name</span>&gt;</span>characterEncodingFilter<span class="hljs-tag">&lt;/<span class="hljs-name">filter-name</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">filter-class</span>&gt;</span>org.springframework.web.filter.CharacterEncodingFilter<span class="hljs-tag">&lt;/<span class="hljs-name">filter-class</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">init-param</span>&gt;</span><br>      <span class="hljs-tag">&lt;<span class="hljs-name">param-name</span>&gt;</span>encoding<span class="hljs-tag">&lt;/<span class="hljs-name">param-name</span>&gt;</span><br>      <span class="hljs-tag">&lt;<span class="hljs-name">param-value</span>&gt;</span>utf-8<span class="hljs-tag">&lt;/<span class="hljs-name">param-value</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">init-param</span>&gt;</span><br>  <span class="hljs-tag">&lt;/<span class="hljs-name">filter</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">filter-mapping</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">filter-name</span>&gt;</span>characterEncodingFilter<span class="hljs-tag">&lt;/<span class="hljs-name">filter-name</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">url-pattern</span>&gt;</span>/*<span class="hljs-tag">&lt;/<span class="hljs-name">url-pattern</span>&gt;</span><br>  <span class="hljs-tag">&lt;/<span class="hljs-name">filter-mapping</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">servlet</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">servlet-name</span>&gt;</span>dispatcherServlet<span class="hljs-tag">&lt;/<span class="hljs-name">servlet-name</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">servlet-class</span>&gt;</span>org.springframework.web.servlet.DispatcherServlet<span class="hljs-tag">&lt;/<span class="hljs-name">servlet-class</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">init-param</span>&gt;</span><br>      <span class="hljs-tag">&lt;<span class="hljs-name">param-name</span>&gt;</span>contextConfigLocation<span class="hljs-tag">&lt;/<span class="hljs-name">param-name</span>&gt;</span><br>      <span class="hljs-tag">&lt;<span class="hljs-name">param-value</span>&gt;</span>classpath:springMvc.xml<span class="hljs-tag">&lt;/<span class="hljs-name">param-value</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">init-param</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">load-on-startup</span>&gt;</span>1<span class="hljs-tag">&lt;/<span class="hljs-name">load-on-startup</span>&gt;</span><br>  <span class="hljs-tag">&lt;/<span class="hljs-name">servlet</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">servlet-mapping</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">servlet-name</span>&gt;</span>dispatcherServlet<span class="hljs-tag">&lt;/<span class="hljs-name">servlet-name</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">url-pattern</span>&gt;</span>/<span class="hljs-tag">&lt;/<span class="hljs-name">url-pattern</span>&gt;</span><br>  <span class="hljs-tag">&lt;/<span class="hljs-name">servlet-mapping</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">web-app</span>&gt;</span><br></code></pre></td></tr></table></figure>

<p>事务管理(在service实现类上边标注)</p>
<p>xml形式</p>
<p><em>在spring配置文件中加上</em></p>
<figure class="highlight xml"><table><tr><td class="code"><pre><code class="hljs xml"><span class="hljs-comment">&lt;!--    配置事务管理--&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">bean</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;dataSourceTransactionManager&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;org.springframework.jdbc.datasource.DataSourceTransactionManager&quot;</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;dataSource&quot;</span> <span class="hljs-attr">ref</span>=<span class="hljs-string">&quot;dataSource&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">bean</span>&gt;</span><br><span class="hljs-comment">&lt;!--配置事务管理的通知--&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">tx:advice</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;txManager&quot;</span> <span class="hljs-attr">transaction-manager</span>=<span class="hljs-string">&quot;dataSourceTransactionManager&quot;</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">tx:attributes</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">tx:method</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;find*&quot;</span> <span class="hljs-attr">read-only</span>=<span class="hljs-string">&quot;true&quot;</span> <span class="hljs-attr">propagation</span>=<span class="hljs-string">&quot;SUPPORTS&quot;</span>/&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">tx:method</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;*&quot;</span> <span class="hljs-attr">read-only</span>=<span class="hljs-string">&quot;false&quot;</span> <span class="hljs-attr">propagation</span>=<span class="hljs-string">&quot;REQUIRED&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">tx:method</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">tx:attributes</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">tx:advice</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">aop:config</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">aop:pointcut</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;pot1&quot;</span> <span class="hljs-attr">expression</span>=<span class="hljs-string">&quot;execution(* com.mySSM.service.*..*(..))&quot;</span>/&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">aop:advisor</span> <span class="hljs-attr">advice-ref</span>=<span class="hljs-string">&quot;txManager&quot;</span> <span class="hljs-attr">pointcut-ref</span>=<span class="hljs-string">&quot;pot1&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">aop:advisor</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">aop:config</span>&gt;</span><br></code></pre></td></tr></table></figure>

<p>注解形式(在service实现类上面注解@Transactional)</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><code class="hljs xml"><span class="hljs-comment">&lt;!--    配置事务管理--&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">bean</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;dataSourceTransactionManager&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;org.springframework.jdbc.datasource.DataSourceTransactionManager&quot;</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;dataSource&quot;</span> <span class="hljs-attr">ref</span>=<span class="hljs-string">&quot;dataSource&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">bean</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">tx:annotation-driven</span> <span class="hljs-attr">transaction-manager</span>=<span class="hljs-string">&quot;dataSourceTransactionManager&quot;</span>/&gt;</span><br></code></pre></td></tr></table></figure>



<p>分页功能实现</p>
<p>导入依赖</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><code class="hljs xml"><span class="hljs-comment">&lt;!--    分页功能插件--&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>      <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>com.github.pagehelper<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>      <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>pageHelper<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>      <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>5.1.10<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br></code></pre></td></tr></table></figure>

<p>在spring配置文件中设置插件</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">bean</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;sqlSessionFactoryBean&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;org.mybatis.spring.SqlSessionFactoryBean&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;dataSource&quot;</span> <span class="hljs-attr">ref</span>=<span class="hljs-string">&quot;dataSource&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;typeAliasesPackage&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;com.mySSM.pojo&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;plugins&quot;</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">array</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">bean</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;com.github.pagehelper.PageInterceptor&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">bean</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">array</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">bean</span>&gt;</span><br></code></pre></td></tr></table></figure>

<p>在service层添加功能</p>
<figure class="highlight java"><table><tr><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Override</span><br><span class="hljs-keyword">public</span> PageInfo&lt;Admin&gt; <span class="hljs-title function_">findAlls</span><span class="hljs-params">(Integer start, Integer counts)</span> &#123;<br>    PageHelper.startPage(start,counts);<br>    List&lt;Admin&gt; all = adminDao.findAll();<br>    PageInfo&lt;Admin&gt; adminPageInfo=<span class="hljs-keyword">new</span> <span class="hljs-title class_">PageInfo</span>&lt;&gt;(all);<br>    <span class="hljs-keyword">return</span> adminPageInfo;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>controller添加</p>
<figure class="highlight java"><table><tr><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@RequestMapping(&quot;/findAllAdmins&quot;)</span><br>    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">findAllAdmins</span><span class="hljs-params">(HttpServletRequest request, HttpServletResponse response, Integer start, Integer end)</span> <span class="hljs-keyword">throws</span> ServletException, IOException &#123;<br>        PageInfo&lt;Admin&gt; alls = adminService.findAlls(start, end);<br>        request.setAttribute(<span class="hljs-string">&quot;userInfos&quot;</span>,alls);<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;userInfos&quot;</span>;<br>    &#125;<br></code></pre></td></tr></table></figure>

<p>jsp：</p>
<figure class="highlight jsp"><table><tr><td class="code"><pre><code class="hljs jsp">&lt;table&gt;<br>    &lt;tr&gt;<br>        &lt;th&gt;id&lt;/th&gt;<br>        &lt;th&gt;用户名&lt;/th&gt;<br>        &lt;th&gt;密码&lt;/th&gt;<br>        &lt;th&gt;钱数&lt;/th&gt;<br>    &lt;/tr&gt;<br>    &lt;c:forEach items=<span class="hljs-string">&quot;$&#123;userInfos.list&#125;&quot;</span> <span class="hljs-keyword">var</span>=<span class="hljs-string">&quot;item&quot;</span>&gt;<br>        &lt;tr&gt;<br>            &lt;td&gt;$&#123;item.id&#125;&lt;/td&gt;<br>            &lt;td&gt;$&#123;item.username&#125;&lt;/td&gt;<br>            &lt;td&gt;$&#123;item.password&#125;&lt;/td&gt;<br>            &lt;td&gt;$&#123;item.money&#125;&lt;/td&gt;<br>        &lt;/tr&gt;<br>    &lt;/c:forEach&gt;<br>    当前页码:$&#123;userInfos.pageNum&#125;<br>&lt;/table&gt;<br></code></pre></td></tr></table></figure>

<p>pageNum	当前页码<br>pageSize	每页显示多少条数据<br>size	当前页显示多少条数据<br>startRow	第几条数据开始显示<br>endRow	显示到第几条数据<br>total	总共多少条数据<br>pages	总共多少页<br>startRow	第几条数据开始显示<br>list	查询的数据封装成列表<br>startRow	第几条数据开始显示<br>prePage	上一页<br>nextPage	下一页<br>isFirstPage	是否第一页<br>isLastPage	是否最后一页<br>hasPreviousPage	是否有上一页<br>hasNextPage	是否有下一页<br>navigatePages	显示多少个页码<br>navigateFirstPage	显示的第一个页码<br>navigateLagePage	显示的最后一个页码<br>navigatepageNums	将显示的页码封装成列表</p>
 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/SSM%E6%A1%86%E6%9E%B6/" rel="tag">SSM框架</a></li></ul>

    </footer>
  </div>

   
    
</article>

    
  </article>
  

  
</section>
</div>

      <footer class="footer">
  <div class="outer">
    <ul>
      <li>
        Copyrights &copy;
        2015-2022
        <i class="ri-heart-fill heart_icon"></i> ahui
      </li>
    </ul>
    <ul>
      <li>
        
      </li>
    </ul>
    <ul>
      <li>
        
        
        <span>
  <span><i class="ri-user-3-fill"></i>访问人数:<span id="busuanzi_value_site_uv"></span></span>
  <span class="division">|</span>
  <span><i class="ri-eye-fill"></i>浏览次数:<span id="busuanzi_value_page_pv"></span></span>
</span>
        
      </li>
    </ul>
    <ul>
      
    </ul>
    <ul>
      
    </ul>
    <ul>
      <li>
        <!-- cnzz统计 -->
        
        <script type="text/javascript" src='https://s9.cnzz.com/z_stat.php?id=1278069914&amp;web_id=1278069914'></script>
        
      </li>
    </ul>
  </div>
</footer>    
    </main>
    <div class="float_btns">
      <div class="totop" id="totop">
  <i class="ri-arrow-up-line"></i>
</div>

<div class="todark" id="todark">
  <i class="ri-moon-line"></i>
</div>

    </div>
    <aside class="sidebar on">
      <button class="navbar-toggle"></button>
<nav class="navbar">
  
  <div class="logo">
    <a href="/"><img src="/images/ayer-side.svg" alt=""></a>
  </div>
  
  <ul class="nav nav-main">
    
    <li class="nav-item">
      <a class="nav-item-link" href="/">主页</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/archives">归档</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/categories">分类</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/tags">标签</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/tags/%E6%97%85%E8%A1%8C/">旅行</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" target="_blank" rel="noopener" href="http://shenyu-vip.lofter.com">摄影</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/friends">友链</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/2019/about">关于我</a>
    </li>
    
  </ul>
</nav>
<nav class="navbar navbar-bottom">
  <ul class="nav">
    <li class="nav-item">
      
      <a class="nav-item-link nav-item-search"  title="搜索">
        <i class="ri-search-line"></i>
      </a>
      
      
      <a class="nav-item-link" target="_blank" href="/atom.xml" title="RSS Feed">
        <i class="ri-rss-line"></i>
      </a>
      
    </li>
  </ul>
</nav>
<div class="search-form-wrap">
  <div class="local-search local-search-plugin">
  <input type="search" id="local-search-input" class="local-search-input" placeholder="Search...">
  <div id="local-search-result" class="local-search-result"></div>
</div>
</div>
    </aside>
    <div id="mask"></div>

<!-- #reward -->
<div id="reward">
  <span class="close"><i class="ri-close-line"></i></span>
  <p class="reward-p"><i class="ri-cup-line"></i>请我喝杯咖啡吧~</p>
  <div class="reward-box">
    
    <div class="reward-item">
      <img class="reward-img" src="/images/alipay.jpg">
      <span class="reward-type">支付宝</span>
    </div>
    
    
    <div class="reward-item">
      <img class="reward-img" src="/images/wechat.jpg">
      <span class="reward-type">微信</span>
    </div>
    
  </div>
</div>
    
<script src="/js/jquery-3.6.0.min.js"></script>
 
<script src="/js/lazyload.min.js"></script>

<!-- Tocbot -->

<script src="https://cdn.staticfile.org/jquery-modal/0.9.2/jquery.modal.min.js"></script>
<link
  rel="stylesheet"
  href="https://cdn.staticfile.org/jquery-modal/0.9.2/jquery.modal.min.css"
/>
<script src="https://cdn.staticfile.org/justifiedGallery/3.8.1/js/jquery.justifiedGallery.min.js"></script>

<script src="/dist/main.js"></script>

<!-- ImageViewer -->
 <!-- Root element of PhotoSwipe. Must have class pswp. -->
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    <!-- Background of PhotoSwipe. 
         It's a separate element as animating opacity is faster than rgba(). -->
    <div class="pswp__bg"></div>

    <!-- Slides wrapper with overflow:hidden. -->
    <div class="pswp__scroll-wrap">

        <!-- Container that holds slides. 
            PhotoSwipe keeps only 3 of them in the DOM to save memory.
            Don't modify these 3 pswp__item elements, data is added later on. -->
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        <!-- Default (PhotoSwipeUI_Default) interface on top of sliding area. Can be changed. -->
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                <!--  Controls are self-explanatory. Order can be changed. -->

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" style="display:none" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                <!-- Preloader demo http://codepen.io/dimsemenov/pen/yyBWoR -->
                <!-- element will get class pswp__preloader--active when preloader is running -->
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div>

<link rel="stylesheet" href="https://cdn.staticfile.org/photoswipe/4.1.3/photoswipe.min.css">
<link rel="stylesheet" href="https://cdn.staticfile.org/photoswipe/4.1.3/default-skin/default-skin.min.css">
<script src="https://cdn.staticfile.org/photoswipe/4.1.3/photoswipe.min.js"></script>
<script src="https://cdn.staticfile.org/photoswipe/4.1.3/photoswipe-ui-default.min.js"></script>

<script>
    function viewer_init() {
        let pswpElement = document.querySelectorAll('.pswp')[0];
        let $imgArr = document.querySelectorAll(('.article-entry img:not(.reward-img)'))

        $imgArr.forEach(($em, i) => {
            $em.onclick = () => {
                // slider展开状态
                // todo: 这样不好，后面改成状态
                if (document.querySelector('.left-col.show')) return
                let items = []
                $imgArr.forEach(($em2, i2) => {
                    let img = $em2.getAttribute('data-idx', i2)
                    let src = $em2.getAttribute('data-target') || $em2.getAttribute('src')
                    let title = $em2.getAttribute('alt')
                    // 获得原图尺寸
                    const image = new Image()
                    image.src = src
                    items.push({
                        src: src,
                        w: image.width || $em2.width,
                        h: image.height || $em2.height,
                        title: title
                    })
                })
                var gallery = new PhotoSwipe(pswpElement, PhotoSwipeUI_Default, items, {
                    index: parseInt(i)
                });
                gallery.init()
            }
        })
    }
    viewer_init()
</script> 
<!-- MathJax -->

<!-- Katex -->

<!-- busuanzi  -->
 
<script src="/js/busuanzi-2.3.pure.min.js"></script>
 
<!-- ClickLove -->

<!-- ClickBoom1 -->

<!-- ClickBoom2 -->

<!-- CodeCopy -->
 
<link rel="stylesheet" href="/css/clipboard.css">
 <script src="https://cdn.staticfile.org/clipboard.js/2.0.10/clipboard.min.js"></script>
<script>
  function wait(callback, seconds) {
    var timelag = null;
    timelag = window.setTimeout(callback, seconds);
  }
  !function (e, t, a) {
    var initCopyCode = function(){
      var copyHtml = '';
      copyHtml += '<button class="btn-copy" data-clipboard-snippet="">';
      copyHtml += '<i class="ri-file-copy-2-line"></i><span>COPY</span>';
      copyHtml += '</button>';
      $(".highlight .code pre").before(copyHtml);
      $(".article pre code").before(copyHtml);
      var clipboard = new ClipboardJS('.btn-copy', {
        target: function(trigger) {
          return trigger.nextElementSibling;
        }
      });
      clipboard.on('success', function(e) {
        let $btn = $(e.trigger);
        $btn.addClass('copied');
        let $icon = $($btn.find('i'));
        $icon.removeClass('ri-file-copy-2-line');
        $icon.addClass('ri-checkbox-circle-line');
        let $span = $($btn.find('span'));
        $span[0].innerText = 'COPIED';
        
        wait(function () { // 等待两秒钟后恢复
          $icon.removeClass('ri-checkbox-circle-line');
          $icon.addClass('ri-file-copy-2-line');
          $span[0].innerText = 'COPY';
        }, 2000);
      });
      clipboard.on('error', function(e) {
        e.clearSelection();
        let $btn = $(e.trigger);
        $btn.addClass('copy-failed');
        let $icon = $($btn.find('i'));
        $icon.removeClass('ri-file-copy-2-line');
        $icon.addClass('ri-time-line');
        let $span = $($btn.find('span'));
        $span[0].innerText = 'COPY FAILED';
        
        wait(function () { // 等待两秒钟后恢复
          $icon.removeClass('ri-time-line');
          $icon.addClass('ri-file-copy-2-line');
          $span[0].innerText = 'COPY';
        }, 2000);
      });
    }
    initCopyCode();
  }(window, document);
</script>
 
<!-- CanvasBackground -->

<script>
  if (window.mermaid) {
    mermaid.initialize({ theme: "forest" });
  }
</script>


    
    

  </div>
</body>

</html>